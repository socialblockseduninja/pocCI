function S3V4Signer(a,b,c,d,e,f,g,h){function i(a,b){var c=[],d=p();return c.push(t.algorithm+" Credential="+a.accessKeyId+"/"+d),c.push("SignedHeaders="+o()),c.push("Signature="+b),c.join(", ")}function j(){if(t.queryparams){for(var a,b=/\+/g,c=/([^&=]+)=?([^&]*)/g,d=function(a){return decodeURIComponent(a.replace(b," "))},e=t.queryparams,f={};a=c.exec(e);)f[d(a[1])]=d(a[2]);return k(f)}return""}function k(a){var b=[],c=Object.keys(a).sort();for(var d in c){var e=a[c[d]],f=l(c[d]),g=f+"=";void 0!==e&&null!==e&&(g=f+"="+l(e)),b.push(g)}return b.join("&")}function l(a){var b=encodeURIComponent(a);return b=b.replace(/[^A-Za-z0-9_.~\-%]+/g,escape),b=b.replace(/[*]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()})}function m(){var a=[];for(var b in t.headers)t.headers.hasOwnProperty(b)&&a.push([b,t.headers[b]]);a.sort(function(a,b){return a[0].toLowerCase()<b[0].toLowerCase()?-1:1});var c=[];for(var d in a)if(a.hasOwnProperty(d)){var e=a[d],b=e[0].toLowerCase();s(b)&&c.push(b+":"+n(e[1].toString().trim()))}return c.join("\n")}function n(a){return a.replace(/\s+/g," ").replace(/^\s+|\s+$/g,"")}function o(){var a=[];for(var b in t.headers)s(b.toLowerCase())&&a.push(b.toLowerCase());return a.sort().join(";")}function p(){var a=[];return a.push(t.datetime.substr(0,8)),a.push(t.s3region),a.push("s3"),a.push("aws4_request"),a.join("/")}function q(a){var b;if("string"==typeof a)b=CryptoJS.SHA256(a);else{var c=CryptoJS.lib.WordArray.create(a);b=CryptoJS.SHA256(c)}return b.toString(CryptoJS.enc.Hex)}function r(){var a=q(t.body||"");return t.bodyHash=a,a}function s(a){var b=["authorization","content-type","content-length","user-agent","expires"];return 0===a.toLowerCase().indexOf("x-amz-")?!0:b.indexOf(a)<0}var t=this;t.headers=a,t.method=b,t.path=c,t.algorithm="AWS4-HMAC-SHA256",t.credentials=e,t.datetime=void 0,t.body=d,t.bodyHash=void 0,t.host=f,t.queryparams=g,h?t.s3region=h:t.s3region="ap-southeast-1","/"!=t.path[0]&&(t.path="/"+t.path),r(),t.datetime=(new Date).toISOString().replace(/\.\d{3}Z$/,"Z").replace(/[:\-]|\.\d{3}/g,""),t.bodyHash?t.headers["X-Amz-Content-Sha256"]=t.bodyHash:console.error("INVALID BODYHASH!!!!!!!"),t.headers["x-amz-date"]=t.datetime,t.headers.host=t.host,t.addAuthorization=function(a){t.headers.Authorization=i(t.credentials,a)},t.getStringToSignWithOutCanonical=function(){var a=[];return a.push("AWS4-HMAC-SHA256"),a.push(t.datetime),a.push(p()),a.join("\n")},t.getDateAndRegion=function(){return"date="+t.datetime.substr(0,8)+"&region="+t.s3region},t.canonicalString=function(){var a=[];return a.push(t.method),a.push(t.path),a.push(j()),a.push(m()+"\n"),a.push(o()),a.push(t.bodyHash),a.join("\n")}}var CryptoJS=CryptoJS||function(a,b){var c={},d=c.lib={},e=function(){},f=d.Base={extend:function(a){e.prototype=this;var b=new e;return a&&b.mixIn(a),b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},g=d.WordArray=f.extend({init:function(a,c){a=this.words=a||[],this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||i).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;if(a=a.sigBytes,this.clamp(),d%4)for(var e=0;a>e;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-8*(e%4)&255)<<24-8*((d+e)%4);else if(65535<c.length)for(e=0;a>e;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);return this.sigBytes+=a,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-8*(c%4),b.length=a.ceil(c/4)},clone:function(){var a=f.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;b>d;d+=4)c.push(4294967296*a.random()|0);return new g.init(c,b)}}),h=c.enc={},i=h.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++){var e=b[d>>>2]>>>24-8*(d%4)&255;c.push((e>>>4).toString(16)),c.push((15&e).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-4*(d%8);return new g.init(c,b/2)}},j=h.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-8*(d%4)&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-8*(d%4);return new g.init(c,b)}},k=h.Utf8={stringify:function(a){try{return decodeURIComponent(escape(j.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data")}},parse:function(a){return j.parse(unescape(encodeURIComponent(a)))}},l=d.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=k.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,f=this.blockSize,h=e/(4*f),h=b?a.ceil(h):a.max((0|h)-this._minBufferSize,0);if(b=h*f,e=a.min(4*b,e),b){for(var i=0;b>i;i+=f)this._doProcessBlock(d,i);i=d.splice(0,b),c.sigBytes-=e}return new g.init(i,e)},clone:function(){var a=f.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0});d.Hasher=l.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new m.HMAC.init(a,c).finalize(b)}}});var m=c.algo={};return c}(Math);!function(a){for(var b=CryptoJS,c=b.lib,d=c.WordArray,e=c.Hasher,c=b.algo,f=[],g=[],h=function(a){return 4294967296*(a-(0|a))|0},i=2,j=0;64>j;){var k;a:{k=i;for(var l=a.sqrt(k),m=2;l>=m;m++)if(!(k%m)){k=!1;break a}k=!0}k&&(8>j&&(f[j]=h(a.pow(i,.5))),g[j]=h(a.pow(i,1/3)),j++),i++}var n=[],c=c.SHA256=e.extend({_doReset:function(){this._hash=new d.init(f.slice(0))},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],f=c[2],h=c[3],i=c[4],j=c[5],k=c[6],l=c[7],m=0;64>m;m++){if(16>m)n[m]=0|a[b+m];else{var o=n[m-15],p=n[m-2];n[m]=((o<<25|o>>>7)^(o<<14|o>>>18)^o>>>3)+n[m-7]+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+n[m-16]}o=l+((i<<26|i>>>6)^(i<<21|i>>>11)^(i<<7|i>>>25))+(i&j^~i&k)+g[m]+n[m],p=((d<<30|d>>>2)^(d<<19|d>>>13)^(d<<10|d>>>22))+(d&e^d&f^e&f),l=k,k=j,j=i,i=h+o|0,h=f,f=e,e=d,d=o+p|0}c[0]=c[0]+d|0,c[1]=c[1]+e|0,c[2]=c[2]+f|0,c[3]=c[3]+h|0,c[4]=c[4]+i|0,c[5]=c[5]+j|0,c[6]=c[6]+k|0,c[7]=c[7]+l|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;return c[e>>>5]|=128<<24-e%32,c[(e+64>>>9<<4)+14]=a.floor(d/4294967296),c[(e+64>>>9<<4)+15]=d,b.sigBytes=4*c.length,this._process(),this._hash},clone:function(){var a=e.clone.call(this);return a._hash=this._hash.clone(),a}});b.SHA256=e._createHelper(c),b.HmacSHA256=e._createHmacHelper(c)}(Math),function(){if("function"==typeof ArrayBuffer){var a=CryptoJS.lib.WordArray,b=a.init;(a.init=function(a){if(a instanceof ArrayBuffer&&(a=new Uint8Array(a)),(a instanceof Int8Array||a instanceof Uint8ClampedArray||a instanceof Int16Array||a instanceof Uint16Array||a instanceof Int32Array||a instanceof Uint32Array||a instanceof Float32Array||a instanceof Float64Array)&&(a=new Uint8Array(a.buffer,a.byteOffset,a.byteLength)),a instanceof Uint8Array){for(var c=a.byteLength,d=[],e=0;c>e;e++)d[e>>>2]|=a[e]<<24-8*(e%4);b.call(this,d,c)}else b.apply(this,arguments)}).prototype=a}}(),function(){var a=CryptoJS,b=a.lib.WordArray;a.enc.Base64={stringify:function(a){var b=a.words,c=a.sigBytes,d=this._map;a.clamp(),a=[];for(var e=0;c>e;e+=3)for(var f=(b[e>>>2]>>>24-8*(e%4)&255)<<16|(b[e+1>>>2]>>>24-8*((e+1)%4)&255)<<8|b[e+2>>>2]>>>24-8*((e+2)%4)&255,g=0;4>g&&c>e+.75*g;g++)a.push(d.charAt(f>>>6*(3-g)&63));if(b=d.charAt(64))for(;a.length%4;)a.push(b);return a.join("")},parse:function(a){var c=a.length,d=this._map,e=d.charAt(64);e&&(e=a.indexOf(e),-1!=e&&(c=e));for(var e=[],f=0,g=0;c>g;g++)if(g%4){var h=d.indexOf(a.charAt(g-1))<<2*(g%4),i=d.indexOf(a.charAt(g))>>>6-2*(g%4);e[f>>>2]|=(h|i)<<24-8*(f%4),f++}return b.create(e,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}();var CryptoJS=CryptoJS||function(a,b){var c={},d=c.lib={},e=function(){},f=d.Base={extend:function(a){e.prototype=this;var b=new e;return a&&b.mixIn(a),b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},g=d.WordArray=f.extend({init:function(a,c){a=this.words=a||[],this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||i).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;if(a=a.sigBytes,this.clamp(),d%4)for(var e=0;a>e;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-8*(e%4)&255)<<24-8*((d+e)%4);else if(65535<c.length)for(e=0;a>e;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);return this.sigBytes+=a,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-8*(c%4),b.length=a.ceil(c/4)},clone:function(){var a=f.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;b>d;d+=4)c.push(4294967296*a.random()|0);return new g.init(c,b)}}),h=c.enc={},i=h.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++){var e=b[d>>>2]>>>24-8*(d%4)&255;c.push((e>>>4).toString(16)),c.push((15&e).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-4*(d%8);return new g.init(c,b/2)}},j=h.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-8*(d%4)&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-8*(d%4);return new g.init(c,b)}},k=h.Utf8={stringify:function(a){try{return decodeURIComponent(escape(j.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data")}},parse:function(a){return j.parse(unescape(encodeURIComponent(a)))}},l=d.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=k.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,f=this.blockSize,h=e/(4*f),h=b?a.ceil(h):a.max((0|h)-this._minBufferSize,0);if(b=h*f,e=a.min(4*b,e),b){for(var i=0;b>i;i+=f)this._doProcessBlock(d,i);i=d.splice(0,b),c.sigBytes-=e}return new g.init(i,e)},clone:function(){var a=f.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0});d.Hasher=l.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new m.HMAC.init(a,c).finalize(b)}}});var m=c.algo={};return c}(Math);!function(a){for(var b=CryptoJS,c=b.lib,d=c.WordArray,e=c.Hasher,c=b.algo,f=[],g=[],h=function(a){return 4294967296*(a-(0|a))|0},i=2,j=0;64>j;){var k;a:{k=i;for(var l=a.sqrt(k),m=2;l>=m;m++)if(!(k%m)){k=!1;break a}k=!0}k&&(8>j&&(f[j]=h(a.pow(i,.5))),g[j]=h(a.pow(i,1/3)),j++),i++}var n=[],c=c.SHA256=e.extend({_doReset:function(){this._hash=new d.init(f.slice(0))},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],f=c[2],h=c[3],i=c[4],j=c[5],k=c[6],l=c[7],m=0;64>m;m++){if(16>m)n[m]=0|a[b+m];else{var o=n[m-15],p=n[m-2];n[m]=((o<<25|o>>>7)^(o<<14|o>>>18)^o>>>3)+n[m-7]+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+n[m-16]}o=l+((i<<26|i>>>6)^(i<<21|i>>>11)^(i<<7|i>>>25))+(i&j^~i&k)+g[m]+n[m],p=((d<<30|d>>>2)^(d<<19|d>>>13)^(d<<10|d>>>22))+(d&e^d&f^e&f),l=k,k=j,j=i,i=h+o|0,h=f,f=e,e=d,d=o+p|0}c[0]=c[0]+d|0,c[1]=c[1]+e|0,c[2]=c[2]+f|0,c[3]=c[3]+h|0,c[4]=c[4]+i|0,c[5]=c[5]+j|0,c[6]=c[6]+k|0,c[7]=c[7]+l|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;return c[e>>>5]|=128<<24-e%32,c[(e+64>>>9<<4)+14]=a.floor(d/4294967296),c[(e+64>>>9<<4)+15]=d,b.sigBytes=4*c.length,this._process(),this._hash},clone:function(){var a=e.clone.call(this);return a._hash=this._hash.clone(),a}});b.SHA256=e._createHelper(c),b.HmacSHA256=e._createHmacHelper(c)}(Math),function(){var a=CryptoJS,b=a.enc.Utf8;a.algo.HMAC=a.lib.Base.extend({init:function(a,c){a=this._hasher=new a.init,"string"==typeof c&&(c=b.parse(c));var d=a.blockSize,e=4*d;c.sigBytes>e&&(c=a.finalize(c)),c.clamp();for(var f=this._oKey=c.clone(),g=this._iKey=c.clone(),h=f.words,i=g.words,j=0;d>j;j++)h[j]^=1549556828,i[j]^=909522486;f.sigBytes=g.sigBytes=e,this.reset()},reset:function(){var a=this._hasher;a.reset(),a.update(this._iKey)},update:function(a){return this._hasher.update(a),this},finalize:function(a){var b=this._hasher;return a=b.finalize(a),b.reset(),b.finalize(this._oKey.clone().concat(a))}})}(),function(){var a=function(a){function b(a){var b=s.length;return s.push(new f(g({progress:function(){},complete:function(){},cancelled:function(){},info:function(){},warn:function(){},error:function(){}},a,{id:b,status:i,priority:0,onStatusChange:c,loadedBytes:0,sizeBytes:a.file.size}))),b}function c(){t.d("onFileUploadStatusChange"),e()}function d(){setTimeout(e,1)}function e(){t.d("processQueue   length: "+s.length);var a=-1,b=-1,c=!0;s.forEach(function(d,e){d.priority>b&&d.status==i&&(a=e,b=d.priority),d.status==j&&(c=!1)}),c&&a>=0&&s[a].start()}function f(b){function c(a){(a==k||a==m||a==l)&&(clearInterval(C),clearInterval(D)),E.status=a,E.onStatusChange()}function d(){t.d("cancelAllRequests()"),H.forEach(function(a,b){a.abort()})}function e(){var a={method:"POST",path:B(),queryparams:"uploads",step:"initiate",x_amz_headers:jQuery.extend(!0,{},E.xAmzHeadersAtInitiate),not_signed_headers:jQuery.extend(!0,{},E.notSignedHeadersAtInitiate)};E.contentType&&(a.contentType=E.contentType),a.onErr=function(a){a&&(t.d("onInitiateError for FileUpload "+E.id),E.error("Upload initiate failed",a),c(n))},a.on200=function(b){var c=b.response.match(/<UploadId\>(.+)<\/UploadId\>/);c&&c[1]?(E.uploadId=c[1],t.d("requester success. got uploadId "+E.uploadId),u(),v()):a.onErr()},y(a,function(a){z(a)})}function f(a){var b,d,e,f;f=F[a],f.status=j,G++,f.loadedBytesPrevious=null,b=0===f.attempts++?0:1e3*Math.min(h.maxRetryBackoffSecs,Math.pow(h.retryBackoffPower,f.attempts-2)),t.d("uploadPart #"+a+"     will wait "+b+"ms to try"),e={method:"PUT",path:B(),queryparams:"partNumber="+a+"&uploadId="+E.uploadId,step:"upload #"+a,x_amz_headers:jQuery.extend(!0,{},E.xAmzHeadersAtUpload),attempts:f.attempts,contentType:"application/octet-stream"},e.onErr=function(b,e){if(b){var g="problem uploading part #"+a+",   http status: "+b.status+",   hasErrored: "+!!d+",   part status: "+f.status+",   readyState: "+b.readyState+(e?",   isOnError":"");if(t.w(g),E.warn(g),d)return;if(d=!0,404==b.status||f.attempts>h.maxRetryTimes){var i="404 error or max retries exceed resulted in abortion of both this part and the entire file.";t.w(i+" Server response: "+b.response),E.error(i),f.status=n,c(n)}else f.status=m,f.loadedBytes=0,v();b.abort()}else{var i="Uploading file failed. File reading error";console.error("problem uploading part #"+a),E.error(i),f.loadedBytes=0,v()}},e.on200=function(b){var c,d=b.getResponseHeader("ETag");t.d("uploadPart 200 response for part #"+a+"     ETag: "+d),f.isEmpty||d!=q?(f.eTag=d,f.status=k):(f.status=m,f.loadedBytes=0,c="eTag matches MD5 of 0 length blob for part #"+a+"   Retrying part.",t.w(c),E.warn(c)),v()},e.onProgress=function(a){f.loadedBytes=a.loaded};var g=E.file.slice?"slice":E.file.mozSlice?"mozSlice":"webkitSlice";e.toSend=function(){var b=E.file[g](f.start,f.end);return t.d("sending part # "+a+" (bytes "+f.start+" -> "+f.end+")  reported length: "+b.size),f.isEmpty||0!==b.size||t.w("  *** WARN: blob reporting size of 0 bytes. Will try upload anyway.."),b},e.onFailedAuth=function(b){var c="onFailedAuth for uploadPart #"+a+".   Will set status to ERROR";t.w(c),E.warn(c),f.status=m,f.loadedBytes=0,v()},y(e,function(c){setTimeout(function(){z(c),t.d("upload #",a,e)},b)}),f.uploader=e}function r(a){var b=F[a];b.uploader.awsXhr&&b.uploader.awsXhr.abort(),b.uploader.authXhr&&b.uploader.authXhr.abort()}function s(){t.d("completeUpload"),E.info("will attempt to complete upload");var a="<CompleteMultipartUpload>";F.forEach(function(b,c){b&&(a+="<Part><PartNumber>"+c+"</PartNumber><ETag>"+b.eTag+"</ETag></Part>")}),a+="</CompleteMultipartUpload>";var b={method:"POST",contentType:"application/xml; charset=UTF-8",path:B(),queryparams:"uploadId="+E.uploadId,x_amz_headers:jQuery.extend(!0,{},E.xAmzHeadersAtComplete),step:"complete"};b.onErr=function(){var a="Error completing upload.";t.w(a),E.error(a),c(m)},b.on200=function(a){E.complete(a),c(k)},b.toSend=function(){return a},y(b,function(a){z(a)})}function u(){for(var a=Math.ceil(E.file.size/h.partSize)||1,b=1;a>=b;b++)F[b]={status:i,start:(b-1)*h.partSize,end:b*h.partSize,attempts:0,loadedBytes:0,loadedBytesPrevious:null,isEmpty:0===E.file.size}}function v(){var a,b=0,c=!0,d=!1,e=[],g=[];return E.status!=j?void E.info("will not process parts list, as not currently evaporating"):(F.forEach(function(a,k){var l=!1;if(e.push(a.status),a){switch(a.status){case j:c=!1,b++,g.push(a.loadedBytes);break;case m:d=!0,l=!0;break;case i:l=!0}l&&(c=!1,b<h.maxConcurrentParts&&(f(k),b++))}}),a=e.toString()+" // bytesLoaded: "+g.toString(),t.d("processPartsList()  anyPartHasErrored: "+d,a),(G>=F.length-1||d)&&E.info("part stati: "+a),void(c&&s()))}function w(){C=setInterval(function(){var a=0;F.forEach(function(b,c){a+=b.loadedBytes}),E.progress(a,E.sizeBytes)},h.progressIntervalMS)}function x(){D=setInterval(function(){t.d("monitorPartsProgress() "+Date()),F.forEach(function(a,b){var c;return a.status!=j?void t.d(b,"not evaporating "):null===a.loadedBytesPrevious?(t.d(b,"no previous "),void(a.loadedBytesPrevious=a.loadedBytes)):(c=a.loadedBytesPrevious<a.loadedBytes,h.simulateStalling&&4==b&&Math.random()<.25&&(c=!1),t.d(b,c?"moving. ":"stalled.",a.loadedBytesPrevious,a.loadedBytes),c||setTimeout(function(){E.info("part #"+b+" stalled. will abort. "+a.loadedBytesPrevious+" "+a.loadedBytes),r(b)},0),void(a.loadedBytesPrevious=a.loadedBytes))})},12e4)}function y(a,b){t.d("setupRequest()",a);var c=new Date;if(h.timeUrl){var d=new XMLHttpRequest;d.open("GET",h.timeUrl+"?requestTime="+c.getTime(),!1),d.send(),a.dateString=d.responseText}else a.dateString=A(c)+"T000000Z";if(a.onGotAuth=function(){var b=new XMLHttpRequest;H.push(b),a.awsXhr=b;var c=a.payload,d=o+a.path+"?"+a.queryparams,e={};g(e,a.not_signed_headers),g(e,a.x_amz_headers),h.simulateErrors&&1==a.attempts&&"upload #3"==a.step&&(t.d("simulating error by POST part #3 to invalid url"),d="https:///foo"),b.open(a.method,d);for(var f in e)e.hasOwnProperty(f)&&"Content-Length"!==f&&"User-Agent"!==f&&"host"!==f&&b.setRequestHeader(f,e[f]);a.contentType&&b.setRequestHeader("Content-Type",a.contentType),b.onreadystatechange=function(){4==b.readyState&&(c&&t.d("  ### "+c.size),200==b.status?a.on200(b):a.onErr(b))},b.onerror=function(){a.onErr(b,!0)},"function"==typeof a.onProgress&&(b.upload.onprogress=function(b){a.onProgress(b)}),b.send(c)},a.onFailedAuth=a.onFailedAuth||function(b){E.error("Error onFailedAuth for step: "+a.step),a.onErr(b)},a.toSend&&a.toSend()instanceof Blob){var e=new FileReader;e.onload=function(c){c.target.readyState==FileReader.DONE&&(a.payload=c.target.result,b(a))},e.onerror=function(b){console.error("File reading failed"),a.onErr()};var f=a.toSend();e.readAsArrayBuffer(f)}else a.payload=a.toSend?a.toSend():null,b(a)}function z(b){t.d("authorizedSend() "+b.step);var c=new XMLHttpRequest;H.push(c),b.authXhr=c;var d="https://api.learnyst.com/drm/getSignedURL",e="ap-southeast-1";h&&h.urlParams&&h.urlParams.s3region&&(e=h.urlParams.s3region);var f,g=b.payload,i=new S3V4Signer(b.x_amz_headers,b.method,b.path,g,{accessKeyId:h.aws_key},p,b.queryparams,e);if(b.v4Signer=i,"undefined"!=typeof h.urlParams&&""!==h.urlParams){var j="";for(key in a.urlParams)j+=key+"="+a.urlParams[key]+"&";j=j.substring(0,j.length-1),d=d+"?str1="+escape(i.getStringToSignWithOutCanonical())+"&str2="+escape(i.canonicalString())+"&"+i.getDateAndRegion()+"&"+j}else d=d+"?str1="+escape(i.getStringToSignWithOutCanonical())+"&str2="+escape(i.canonicalString())+"&"+i.getDateAndRegion();d+="&version=1",c.onreadystatechange=function(){4==c.readyState&&(200==c.status&&64==c.response.length?(t.d("authorizedSend got signature for step: '"+b.step+"'    sig: "+c.response),b.auth=c.response,b.v4Signer.addAuthorization(c.response),b.onGotAuth()):(f="failed to get authorization (readyState=4) for "+b.step+".  xhr.status: "+c.status+".  xhr.response: "+c.response,t.w(f),E.warn(f),b.onFailedAuth(c)))},c.onerror=function(){f="failed to get authorization (onerror) for "+b.step+".  xhr.status: "+c.status+".  xhr.response: "+c.response,t.w(f),E.warn(f),b.onFailedAuth(c)},c.open("GET",d),c.setRequestHeader("Authorization","Bearer "+h.lrToken),c.send()}function A(a){var b=a.getFullYear(),c=a.getMonth()+1,d=a.getDate();return String(1e4*b+100*c+d)}function B(){var a=E.uploadPath+"/"+E.name;return(h.cloudfront||o.indexOf("cloudfront")>-1)&&(a="/"+E.name),a}var C,D,E=this,F=[],G=0,H=[];g(E,b),E.start=function(){t.d("starting FileUpload "+E.id),c(j),e(),w(),x()},E.stop=function(){t.d("stopping FileUpload ",E.id),E.cancelled(),E.info("upload canceled"),c(l),d()}}function g(a,b,c){if("undefined"==typeof a&&(a={}),"object"==typeof c)for(var d in c)b[d]=c[d];for(var e in b)a[e]=b[e];return a}if(this.supported=!("undefined"==typeof File||"undefined"==typeof Blob||!(Blob.prototype.webkitSlice||Blob.prototype.mozSlice||Blob.prototype.slice)||a.testUnsupported),this.supported){var h=g({logging:!0,maxConcurrentParts:5,partSize:5242880,retryBackoffPower:2,maxRetryBackoffSecs:300,progressIntervalMS:500,cloudfront:!1,encodeFilename:!1,maxRetryTimes:3},a),i=0,j=2,k=3,l=5,m=10,n=20,o="https://"+h.bucket+".s3.amazonaws.com/",p=h.bucket+".s3.amazonaws.com",q='"d41d8cd98f00b204e9800998ecf8427e"',r=this,s=[];r.add=function(a){t.d("add");var c;if("undefined"==typeof a)return"Missing file";if("undefined"==typeof a.name?c="Missing attribute: name  ":h.encodeFilename&&(a.name=a.name.replace(/[^a-zA-Z0-9_.-]/g,"_")),c)return c;var e=b(a);return d(),e},r.cancel=function(a){return t.d("cancel ",a),s[a]?(s[a].stop(),!0):!1},r.pause=function(a){},r.resume=function(a){},r.forceRetry=function(){};var t={d:function(){},w:function(){},e:function(){}};h.logging&&console&&console.log&&(t=console,t.d=t.log,console.warn?t.w=t.warn:t.w=t.log,console.error?t.e=t.error:t.e=t.log)}};"undefined"!=typeof module&&module.exports?module.exports=a:"undefined"!=typeof window&&(window.Evaporate=a)}(),!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){"use strict";function b(a){return"number"==typeof a&&!isNaN(a)}function c(a){return"undefined"==typeof a}function d(a,c){var d=[];return b(c)&&d.push(c),d.slice.apply(a,d)}function e(a,b){var c=d(arguments,2);return function(){return a.apply(b,c.concat(d(arguments)))}}function f(a){var b=a.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return b&&(b[1]!==n.protocol||b[2]!==n.hostname||b[3]!==n.port)}function g(a){var b="timestamp="+(new Date).getTime();return a+(-1===a.indexOf("?")?"?":"&")+b}function h(a){return a?"rotate("+a+"deg)":"none"}function i(a,b){var c,d,e=R(a.degree)%180,f=(e>90?180-e:e)*Math.PI/180,g=S(f),h=T(f),i=a.width,j=a.height,k=a.aspectRatio;return b?(c=i/(h+g/k),d=c/k):(c=i*h+j*g,d=i*g+j*h),{width:c,height:d}}function j(b,c){var d=a("<canvas>")[0],e=d.getContext("2d"),f=c.naturalWidth,g=c.naturalHeight,h=c.rotate,j=i({width:f,height:g,degree:h});return h?(d.width=j.width,d.height=j.height,e.save(),e.translate(j.width/2,j.height/2),e.rotate(h*Math.PI/180),e.drawImage(b,-f/2,-g/2,f,g),e.restore()):(d.width=f,d.height=g,e.drawImage(b,0,0,f,g)),d}function k(b,c){this.$element=a(b),this.options=a.extend({},k.DEFAULTS,a.isPlainObject(c)&&c),this.ready=!1,this.built=!1,this.rotated=!1,this.cropped=!1,this.disabled=!1,this.replaced=!1,this.isImg=!1,this.originalUrl="",this.canvas=null,this.cropBox=null,this.init()}var l=a(window),m=a(document),n=window.location,o=".cropper",p="preview"+o,q=/^(e|n|w|s|ne|nw|sw|se|all|crop|move|zoom)$/,r="cropper-modal",s="cropper-hide",t="cropper-hidden",u="cropper-invisible",v="cropper-move",w="cropper-crop",x="cropper-disabled",y="cropper-bg",z="mousedown touchstart pointerdown MSPointerDown",A="mousemove touchmove pointermove MSPointerMove",B="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",C="wheel mousewheel DOMMouseScroll",D="dblclick",E="resize"+o,F="build"+o,G="built"+o,H="dragstart"+o,I="dragmove"+o,J="dragend"+o,K="zoomin"+o,L="zoomout"+o,M="change"+o,N=a.isFunction(a("<canvas>")[0].getContext),O=Math.sqrt,P=Math.min,Q=Math.max,R=Math.abs,S=Math.sin,T=Math.cos,U=parseFloat,V={};V.init=function(){var a,b=this.$element;if(b.is("img")){if(this.isImg=!0,this.originalUrl=a=b.attr("src"),!a)return;a=b.prop("src")}else b.is("canvas")&&N&&(a=b[0].toDataURL());this.load(a)},V.load=function(b){var c,d,e,h,i=this.options,j=this.$element;b&&(e=a.Event(F),j.one(F,i.build).trigger(e),e.isDefaultPrevented()||(i.checkImageOrigin&&f(b)&&(c=' crossOrigin="anonymous"',j.prop("crossOrigin")||(d=g(b))),this.$clone=h=a("<img"+(c||"")+' src="'+(d||b)+'">'),h.one("load",a.proxy(function(){var a=h[0],c=a.naturalWidth||a.width,d=a.naturalHeight||a.height;this.image={naturalWidth:c,naturalHeight:d,aspectRatio:c/d,rotate:0},this.url=b,this.ready=!0,this.build()},this)).one("error",function(){h.remove()}),h.addClass(s).insertAfter(j)))},V.build=function(){var b,c,d,e=this.$element,f=this.$clone,g=this.options;this.ready&&(this.built&&this.unbuild(),this.$cropper=b=a(k.TEMPLATE),e.addClass(t),f.removeClass(s),this.$container=e.parent().append(b),this.$canvas=b.find(".cropper-canvas").append(f),this.$dragBox=b.find(".cropper-drag-box"),this.$cropBox=c=b.find(".cropper-crop-box"),this.$viewBox=b.find(".cropper-view-box"),this.$face=d=c.find(".cropper-face"),this.addListeners(),this.initPreview(),g.aspectRatio=U(g.aspectRatio)||NaN,g.autoCrop?(this.cropped=!0,g.modal&&this.$dragBox.addClass(r)):c.addClass(t),g.guides||c.find(".cropper-dashed").addClass(t),g.center||c.find(".cropper-center").addClass(t),g.cropBoxMovable&&d.addClass(v).data("drag","all"),g.highlight||d.addClass(u),g.background&&b.addClass(y),g.cropBoxResizable||c.find(".cropper-line, .cropper-point").addClass(t),this.setDragMode(g.dragCrop?"crop":g.movable?"move":"none"),this.built=!0,this.render(),this.setData(g.data),e.one(G,g.built).trigger(G))},V.unbuild=function(){this.built&&(this.built=!1,this.initialImage=null,this.initialCanvas=null,this.initialCropBox=null,this.container=null,this.canvas=null,this.cropBox=null,this.removeListeners(),this.resetPreview(),this.$preview=null,this.$viewBox=null,this.$cropBox=null,this.$dragBox=null,this.$canvas=null,this.$container=null,this.$cropper.remove(),this.$cropper=null)},a.extend(V,{render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var a=this.$element,b=this.$container,c=this.$cropper,d=this.options;c.addClass(t),a.removeClass(t),c.css(this.container={width:Q(b.width(),U(d.minContainerWidth)||200),height:Q(b.height(),U(d.minContainerHeight)||100)}),a.addClass(t),c.removeClass(t)},initCanvas:function(){var b=this.container,c=b.width,d=b.height,e=this.image,f=e.aspectRatio,g={aspectRatio:f,width:c,height:d};d*f>c?g.height=c/f:g.width=d*f,g.oldLeft=g.left=(c-g.width)/2,g.oldTop=g.top=(d-g.height)/2,this.canvas=g,this.limitCanvas(!0,!0),this.initialImage=a.extend({},e),this.initialCanvas=a.extend({},g)},limitCanvas:function(b,c){var d,e,f=this.options,g=f.strict,h=this.container,i=h.width,j=h.height,k=this.canvas,l=k.aspectRatio,m=this.cropBox,n=this.cropped&&m,o=this.initialCanvas||k,p=o.width,q=o.height;b&&(d=U(f.minCanvasWidth)||0,e=U(f.minCanvasHeight)||0,d?(g&&(d=Q(n?m.width:p,d)),e=d/l):e?(g&&(e=Q(n?m.height:q,e)),d=e*l):g&&(n?(d=m.width,e=m.height,e*l>d?d=e*l:e=d/l):(d=p,e=q)),a.extend(k,{minWidth:d,minHeight:e,maxWidth:1/0,maxHeight:1/0})),c&&(g?n?(k.minLeft=P(m.left,m.left+m.width-k.width),k.minTop=P(m.top,m.top+m.height-k.height),k.maxLeft=m.left,k.maxTop=m.top):(k.minLeft=P(0,i-k.width),k.minTop=P(0,j-k.height),k.maxLeft=Q(0,i-k.width),k.maxTop=Q(0,j-k.height)):(k.minLeft=-k.width,k.minTop=-k.height,k.maxLeft=i,k.maxTop=j))},renderCanvas:function(a){var b,c,d=this.options,e=this.canvas,f=this.image;this.rotated&&(this.rotated=!1,c=i({width:f.width,height:f.height,degree:f.rotate}),b=c.width/c.height,b!==e.aspectRatio&&(e.left-=(c.width-e.width)/2,e.top-=(c.height-e.height)/2,e.width=c.width,e.height=c.height,e.aspectRatio=b,this.limitCanvas(!0,!1))),(e.width>e.maxWidth||e.width<e.minWidth)&&(e.left=e.oldLeft),(e.height>e.maxHeight||e.height<e.minHeight)&&(e.top=e.oldTop),e.width=P(Q(e.width,e.minWidth),e.maxWidth),e.height=P(Q(e.height,e.minHeight),e.maxHeight),this.limitCanvas(!1,!0),e.oldLeft=e.left=P(Q(e.left,e.minLeft),e.maxLeft),e.oldTop=e.top=P(Q(e.top,e.minTop),e.maxTop),this.$canvas.css({width:e.width,height:e.height,left:e.left,top:e.top}),this.renderImage(),this.cropped&&d.strict&&this.limitCropBox(!0,!0),a&&this.output()},renderImage:function(){var b,c=this.canvas,d=this.image;d.rotate&&(b=i({width:c.width,height:c.height,degree:d.rotate,aspectRatio:d.aspectRatio},!0)),a.extend(d,b?{width:b.width,height:b.height,left:(c.width-b.width)/2,top:(c.height-b.height)/2}:{width:c.width,height:c.height,left:0,top:0}),this.$clone.css({width:d.width,height:d.height,marginLeft:d.left,marginTop:d.top,transform:h(d.rotate)})},initCropBox:function(){var b=this.options,c=this.canvas,d=b.aspectRatio,e=U(b.autoCropArea)||.8,f={width:c.width,height:c.height};d&&(c.height*d>c.width?f.height=f.width/d:f.width=f.height*d),this.cropBox=f,this.limitCropBox(!0,!0),f.width=P(Q(f.width,f.minWidth),f.maxWidth),f.height=P(Q(f.height,f.minHeight),f.maxHeight),f.width=Q(f.minWidth,f.width*e),f.height=Q(f.minHeight,f.height*e),f.oldLeft=f.left=c.left+(c.width-f.width)/2,f.oldTop=f.top=c.top+(c.height-f.height)/2,this.initialCropBox=a.extend({},f)},limitCropBox:function(a,b){var c,d,e=this.options,f=e.strict,g=this.container,h=g.width,i=g.height,j=this.canvas,k=this.cropBox,l=e.aspectRatio;a&&(c=U(e.minCropBoxWidth)||0,d=U(e.minCropBoxHeight)||0,k.minWidth=P(h,c),k.minHeight=P(i,d),k.maxWidth=P(h,f?j.width:h),k.maxHeight=P(i,f?j.height:i),l&&(k.maxHeight*l>k.maxWidth?(k.minHeight=k.minWidth/l,k.maxHeight=k.maxWidth/l):(k.minWidth=k.minHeight*l,k.maxWidth=k.maxHeight*l)),k.minWidth=P(k.maxWidth,k.minWidth),k.minHeight=P(k.maxHeight,k.minHeight)),b&&(f?(k.minLeft=Q(0,j.left),k.minTop=Q(0,j.top),k.maxLeft=P(h,j.left+j.width)-k.width,k.maxTop=P(i,j.top+j.height)-k.height):(k.minLeft=0,k.minTop=0,k.maxLeft=h-k.width,k.maxTop=i-k.height))},renderCropBox:function(){var a=this.options,b=this.container,c=b.width,d=b.height,e=this.cropBox;(e.width>e.maxWidth||e.width<e.minWidth)&&(e.left=e.oldLeft),(e.height>e.maxHeight||e.height<e.minHeight)&&(e.top=e.oldTop),e.width=P(Q(e.width,e.minWidth),e.maxWidth),e.height=P(Q(e.height,e.minHeight),e.maxHeight),this.limitCropBox(!1,!0),e.oldLeft=e.left=P(Q(e.left,e.minLeft),e.maxLeft),
e.oldTop=e.top=P(Q(e.top,e.minTop),e.maxTop),a.movable&&a.cropBoxMovable&&this.$face.data("drag",e.width===c&&e.height===d?"move":"all"),this.$cropBox.css({width:e.width,height:e.height,left:e.left,top:e.top}),this.cropped&&a.strict&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){var a=this.options,b=this.$element;this.preview(),a.crop&&a.crop.call(b,this.getData()),b.trigger(M)}}),V.initPreview=function(){var b=this.url;this.$preview=a(this.options.preview),this.$viewBox.html('<img src="'+b+'">'),this.$preview.each(function(){var c=a(this);c.data(p,{width:c.width(),height:c.height(),original:c.html()}).html('<img src="'+b+'" style="display:block;width:100%;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation: 0deg!important">')})},V.resetPreview=function(){this.$preview.each(function(){var b=a(this);b.html(b.data(p).original).removeData(p)})},V.preview=function(){var b=this.image,c=this.canvas,d=this.cropBox,e=b.width,f=b.height,g=d.left-c.left-b.left,i=d.top-c.top-b.top,j=b.rotate;this.cropped&&!this.disabled&&(this.$viewBox.find("img").css({width:e,height:f,marginLeft:-g,marginTop:-i,transform:h(j)}),this.$preview.each(function(){var b=a(this),c=b.data(p),k=c.width/d.width,l=c.width,m=d.height*k;m>c.height&&(k=c.height/d.height,l=d.width*k,m=c.height),b.width(l).height(m).find("img").css({width:e*k,height:f*k,marginLeft:-g*k,marginTop:-i*k,transform:h(j)})}))},V.addListeners=function(){var b=this.options,c=this.$element,d=this.$cropper;a.isFunction(b.dragstart)&&c.on(H,b.dragstart),a.isFunction(b.dragmove)&&c.on(I,b.dragmove),a.isFunction(b.dragend)&&c.on(J,b.dragend),a.isFunction(b.zoomin)&&c.on(K,b.zoomin),a.isFunction(b.zoomout)&&c.on(L,b.zoomout),a.isFunction(b.change)&&c.on(M,b.change),d.on(z,a.proxy(this.dragstart,this)),b.zoomable&&b.mouseWheelZoom&&d.on(C,a.proxy(this.wheel,this)),b.doubleClickToggle&&d.on(D,a.proxy(this.dblclick,this)),m.on(A,this._dragmove=e(this.dragmove,this)).on(B,this._dragend=e(this.dragend,this)),b.responsive&&l.on(E,this._resize=e(this.resize,this))},V.removeListeners=function(){var b=this.options,c=this.$element,d=this.$cropper;a.isFunction(b.dragstart)&&c.off(H,b.dragstart),a.isFunction(b.dragmove)&&c.off(I,b.dragmove),a.isFunction(b.dragend)&&c.off(J,b.dragend),a.isFunction(b.zoomin)&&c.off(K,b.zoomin),a.isFunction(b.zoomout)&&c.off(L,b.zoomout),a.isFunction(b.change)&&c.off(M,b.change),d.off(z,this.dragstart),b.zoomable&&b.mouseWheelZoom&&d.off(C,this.wheel),b.doubleClickToggle&&d.off(D,this.dblclick),m.off(A,this._dragmove).off(B,this._dragend),b.responsive&&l.off(E,this._resize)},a.extend(V,{resize:function(){var b,c,d,e=this.$container,f=this.container;!this.disabled&&f&&(d=e.width()/f.width,(1!==d||e.height()!==f.height)&&(b=this.getCanvasData(),c=this.getCropBoxData(),this.render(),this.setCanvasData(a.each(b,function(a,c){b[a]=c*d})),this.setCropBoxData(a.each(c,function(a,b){c[a]=b*d}))))},dblclick:function(){this.disabled||this.setDragMode(this.$dragBox.hasClass(w)?"move":"crop")},wheel:function(a){var b=a.originalEvent,c=1;this.disabled||(a.preventDefault(),b.deltaY?c=b.deltaY>0?1:-1:b.wheelDelta?c=-b.wheelDelta/120:b.detail&&(c=b.detail>0?1:-1),this.zoom(.1*-c))},dragstart:function(b){var c,d,e,f=this.options,g=b.originalEvent,h=g&&g.touches,i=b;if(!this.disabled){if(h){if(e=h.length,e>1){if(!f.zoomable||!f.touchDragZoom||2!==e)return;i=h[1],this.startX2=i.pageX,this.startY2=i.pageY,c="zoom"}i=h[0]}if(c=c||a(i.target).data("drag"),q.test(c)){if(b.preventDefault(),d=a.Event(H,{originalEvent:g,dragType:c}),this.$element.trigger(d),d.isDefaultPrevented())return;this.dragType=c,this.cropping=!1,this.startX=i.pageX,this.startY=i.pageY,"crop"===c&&(this.cropping=!0,this.$dragBox.addClass(r))}}},dragmove:function(b){var c,d,e=this.options,f=b.originalEvent,g=f&&f.touches,h=b,i=this.dragType;if(!this.disabled){if(g){if(d=g.length,d>1){if(!e.zoomable||!e.touchDragZoom||2!==d)return;h=g[1],this.endX2=h.pageX,this.endY2=h.pageY}h=g[0]}if(i){if(b.preventDefault(),c=a.Event(I,{originalEvent:f,dragType:i}),this.$element.trigger(c),c.isDefaultPrevented())return;this.endX=h.pageX,this.endY=h.pageY,this.change(h.shiftKey)}}},dragend:function(b){var c,d=this.dragType;if(!this.disabled&&d){if(b.preventDefault(),c=a.Event(J,{originalEvent:b.originalEvent,dragType:d}),this.$element.trigger(c),c.isDefaultPrevented())return;this.cropping&&(this.cropping=!1,this.$dragBox.toggleClass(r,this.cropped&&this.options.modal)),this.dragType=""}}}),a.extend(V,{crop:function(){this.built&&!this.disabled&&(this.cropped||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&this.$dragBox.addClass(r),this.$cropBox.removeClass(t)),this.setCropBoxData(this.initialCropBox))},reset:function(){this.built&&!this.disabled&&(this.image=a.extend({},this.initialImage),this.canvas=a.extend({},this.initialCanvas),this.cropBox=a.extend({},this.initialCropBox),this.renderCanvas(),this.cropped&&this.renderCropBox())},clear:function(){this.cropped&&!this.disabled&&(a.extend(this.cropBox,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(),this.renderCanvas(),this.$dragBox.removeClass(r),this.$cropBox.addClass(t))},destroy:function(){var a=this.$element;this.ready?(this.isImg&&a.attr("src",this.originalUrl),this.unbuild(),a.removeClass(t)):this.$clone&&this.$clone.remove(),a.removeData("cropper")},replace:function(a){!this.disabled&&a&&(this.isImg&&this.$element.attr("src",a),this.options.data=null,this.load(a))},enable:function(){this.built&&(this.disabled=!1,this.$cropper.removeClass(x))},disable:function(){this.built&&(this.disabled=!0,this.$cropper.addClass(x))},move:function(a,c){var d=this.canvas;this.built&&!this.disabled&&this.options.movable&&b(a)&&b(c)&&(d.left+=a,d.top+=c,this.renderCanvas(!0))},zoom:function(b){var c,d,e,f=this.canvas;if(b=U(b),b&&this.built&&!this.disabled&&this.options.zoomable){if(c=a.Event(b>0?K:L),this.$element.trigger(c),c.isDefaultPrevented())return;b=-1>=b?1/(1-b):1>=b?1+b:b,d=f.width*b,e=f.height*b,f.left-=(d-f.width)/2,f.top-=(e-f.height)/2,f.width=d,f.height=e,this.renderCanvas(!0),this.setDragMode("move")}},rotate:function(a){var b=this.image;a=U(a),a&&this.built&&!this.disabled&&this.options.rotatable&&(b.rotate=(b.rotate+a)%360,this.rotated=!0,this.renderCanvas(!0))},getData:function(b){var c,d,e=this.cropBox,f=this.canvas,g=this.image;return this.built&&this.cropped?(d={x:e.left-f.left,y:e.top-f.top,width:e.width,height:e.height},c=g.width/g.naturalWidth,a.each(d,function(a,e){e/=c,d[a]=b?Math.round(e):e})):d={x:0,y:0,width:0,height:0},d.rotate=this.ready?g.rotate:0,d},setData:function(c){var d,e=this.image,f=this.canvas,g={};this.built&&!this.disabled&&a.isPlainObject(c)&&(b(c.rotate)&&c.rotate!==e.rotate&&this.options.rotatable&&(e.rotate=c.rotate,this.rotated=!0,this.renderCanvas(!0)),d=e.width/e.naturalWidth,b(c.x)&&(g.left=c.x*d+f.left),b(c.y)&&(g.top=c.y*d+f.top),b(c.width)&&(g.width=c.width*d),b(c.height)&&(g.height=c.height*d),this.setCropBoxData(g))},getContainerData:function(){return this.built?this.container:{}},getImageData:function(){return this.ready?this.image:{}},getCanvasData:function(){var a,b=this.canvas;return this.built&&(a={left:b.left,top:b.top,width:b.width,height:b.height}),a||{}},setCanvasData:function(c){var d=this.canvas,e=d.aspectRatio;this.built&&!this.disabled&&a.isPlainObject(c)&&(b(c.left)&&(d.left=c.left),b(c.top)&&(d.top=c.top),b(c.width)?(d.width=c.width,d.height=c.width/e):b(c.height)&&(d.height=c.height,d.width=c.height*e),this.renderCanvas(!0))},getCropBoxData:function(){var a,b=this.cropBox;return this.built&&this.cropped&&(a={left:b.left,top:b.top,width:b.width,height:b.height}),a||{}},setCropBoxData:function(c){var d=this.cropBox,e=this.options.aspectRatio;this.built&&this.cropped&&!this.disabled&&a.isPlainObject(c)&&(b(c.left)&&(d.left=c.left),b(c.top)&&(d.top=c.top),b(c.width)&&(d.width=c.width),b(c.height)&&(d.height=c.height),e&&(b(c.width)?d.height=d.width/e:b(c.height)&&(d.width=d.height*e)),this.renderCropBox())},getCroppedCanvas:function(b){var c,d,e,f,g,h,i,k,l,m,n;return this.built&&this.cropped&&N?(a.isPlainObject(b)||(b={}),n=this.getData(),c=n.width,d=n.height,k=c/d,a.isPlainObject(b)&&(g=b.width,h=b.height,g?(h=g/k,i=g/c):h&&(g=h*k,i=h/d)),e=g||c,f=h||d,l=a("<canvas>")[0],l.width=e,l.height=f,m=l.getContext("2d"),b.fillColor&&(m.fillStyle=b.fillColor,m.fillRect(0,0,e,f)),m.drawImage.apply(m,function(){var a,b,e,f,g,h,k=j(this.$clone[0],this.image),l=k.width,m=k.height,o=[k],p=n.x,q=n.y;return-c>=p||p>l?p=a=e=g=0:0>=p?(e=-p,p=0,a=g=P(l,c+p)):l>=p&&(e=0,a=g=P(c,l-p)),0>=a||-d>=q||q>m?q=b=f=h=0:0>=q?(f=-q,q=0,b=h=P(m,d+q)):m>=q&&(f=0,b=h=P(d,m-q)),o.push(p,q,a,b),i&&(e*=i,f*=i,g*=i,h*=i),g>0&&h>0&&o.push(e,f,g,h),o}.call(this)),l):void 0},setAspectRatio:function(a){var b=this.options;this.disabled||c(a)||(b.aspectRatio=U(a)||NaN,this.built&&(this.initCropBox(),this.cropped&&this.renderCropBox()))},setDragMode:function(a){var b,c,d=this.options;this.ready&&!this.disabled&&(b=d.dragCrop&&"crop"===a,c=d.movable&&"move"===a,a=b||c?a:"none",this.$dragBox.data("drag",a).toggleClass(w,b).toggleClass(v,c),d.cropBoxMovable||this.$face.data("drag",a).toggleClass(w,b).toggleClass(v,c))}}),V.change=function(a){var b,c=this.dragType,d=this.options,e=this.canvas,f=this.container,g=this.cropBox,h=g.width,i=g.height,j=g.left,k=g.top,l=j+h,m=k+i,n=0,o=0,p=f.width,q=f.height,r=!0,s=d.aspectRatio,u={x:this.endX-this.startX,y:this.endY-this.startY};switch(!s&&a&&(s=h&&i?h/i:1),d.strict&&(n=g.minLeft,o=g.minTop,p=n+P(f.width,e.width),q=o+P(f.height,e.height)),s&&(u.X=u.y*s,u.Y=u.x/s),c){case"all":j+=u.x,k+=u.y;break;case"e":if(u.x>=0&&(l>=p||s&&(o>=k||m>=q))){r=!1;break}h+=u.x,s&&(i=h/s,k-=u.Y/2),0>h&&(c="w",h=0);break;case"n":if(u.y<=0&&(o>=k||s&&(n>=j||l>=p))){r=!1;break}i-=u.y,k+=u.y,s&&(h=i*s,j+=u.X/2),0>i&&(c="s",i=0);break;case"w":if(u.x<=0&&(n>=j||s&&(o>=k||m>=q))){r=!1;break}h-=u.x,j+=u.x,s&&(i=h/s,k+=u.Y/2),0>h&&(c="e",h=0);break;case"s":if(u.y>=0&&(m>=q||s&&(n>=j||l>=p))){r=!1;break}i+=u.y,s&&(h=i*s,j-=u.X/2),0>i&&(c="n",i=0);break;case"ne":if(s){if(u.y<=0&&(o>=k||l>=p)){r=!1;break}i-=u.y,k+=u.y,h=i*s}else u.x>=0?p>l?h+=u.x:u.y<=0&&o>=k&&(r=!1):h+=u.x,u.y<=0?k>o&&(i-=u.y,k+=u.y):(i-=u.y,k+=u.y);0>h&&0>i?(c="sw",i=0,h=0):0>h?(c="nw",h=0):0>i&&(c="se",i=0);break;case"nw":if(s){if(u.y<=0&&(o>=k||n>=j)){r=!1;break}i-=u.y,k+=u.y,h=i*s,j+=u.X}else u.x<=0?j>n?(h-=u.x,j+=u.x):u.y<=0&&o>=k&&(r=!1):(h-=u.x,j+=u.x),u.y<=0?k>o&&(i-=u.y,k+=u.y):(i-=u.y,k+=u.y);0>h&&0>i?(c="se",i=0,h=0):0>h?(c="ne",h=0):0>i&&(c="sw",i=0);break;case"sw":if(s){if(u.x<=0&&(n>=j||m>=q)){r=!1;break}h-=u.x,j+=u.x,i=h/s}else u.x<=0?j>n?(h-=u.x,j+=u.x):u.y>=0&&m>=q&&(r=!1):(h-=u.x,j+=u.x),u.y>=0?q>m&&(i+=u.y):i+=u.y;0>h&&0>i?(c="ne",i=0,h=0):0>h?(c="se",h=0):0>i&&(c="nw",i=0);break;case"se":if(s){if(u.x>=0&&(l>=p||m>=q)){r=!1;break}h+=u.x,i=h/s}else u.x>=0?p>l?h+=u.x:u.y>=0&&m>=q&&(r=!1):h+=u.x,u.y>=0?q>m&&(i+=u.y):i+=u.y;0>h&&0>i?(c="nw",i=0,h=0):0>h?(c="sw",h=0):0>i&&(c="ne",i=0);break;case"move":e.left+=u.x,e.top+=u.y,this.renderCanvas(!0),r=!1;break;case"zoom":this.zoom(function(a,b,c,d){var e=O(a*a+b*b),f=O(c*c+d*d);return(f-e)/e}(R(this.startX-this.startX2),R(this.startY-this.startY2),R(this.endX-this.endX2),R(this.endY-this.endY2))),this.startX2=this.endX2,this.startY2=this.endY2,r=!1;break;case"crop":u.x&&u.y&&(b=this.$cropper.offset(),j=this.startX-b.left,k=this.startY-b.top,h=g.minWidth,i=g.minHeight,u.x>0?u.y>0?c="se":(c="ne",k-=i):u.y>0?(c="sw",j-=h):(c="nw",j-=h,k-=i),this.cropped||(this.cropped=!0,this.$cropBox.removeClass(t)))}r&&(g.width=h,g.height=i,g.left=j,g.top=k,this.dragType=c,this.renderCropBox()),this.startX=this.endX,this.startY=this.endY},a.extend(k.prototype,V),k.DEFAULTS={aspectRatio:NaN,autoCropArea:.8,crop:null,data:null,preview:"",strict:!0,responsive:!0,checkImageOrigin:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,dragCrop:!0,movable:!0,rotatable:!0,zoomable:!0,touchDragZoom:!0,mouseWheelZoom:!0,cropBoxMovable:!0,cropBoxResizable:!0,doubleClickToggle:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,dragstart:null,dragmove:null,dragend:null,zoomin:null,zoomout:null,change:null},k.setDefaults=function(b){a.extend(k.DEFAULTS,b)},k.TEMPLATE=function(a,b){return b=b.split(","),a.replace(/\d+/g,function(a){return b[a]})}('<0 6="5-container"><0 6="5-canvas"></0><0 6="5-2-9"></0><0 6="5-crop-9"><1 6="5-view-9"></1><1 6="5-8 8-h"></1><1 6="5-8 8-v"></1><1 6="5-center"></1><1 6="5-face"></1><1 6="5-7 7-e" 3-2="e"></1><1 6="5-7 7-n" 3-2="n"></1><1 6="5-7 7-w" 3-2="w"></1><1 6="5-7 7-s" 3-2="s"></1><1 6="5-4 4-e" 3-2="e"></1><1 6="5-4 4-n" 3-2="n"></1><1 6="5-4 4-w" 3-2="w"></1><1 6="5-4 4-s" 3-2="s"></1><1 6="5-4 4-ne" 3-2="ne"></1><1 6="5-4 4-nw" 3-2="nw"></1><1 6="5-4 4-sw" 3-2="sw"></1><1 6="5-4 4-se" 3-2="se"></1></0></0>',"div,span,drag,data,point,cropper,class,line,dashed,box"),k.other=a.fn.cropper,a.fn.cropper=function(b){var e,f=d(arguments,1);return this.each(function(){var c,d=a(this),g=d.data("cropper");if(!g){if(/destroy/.test(b))return;d.data("cropper",g=new k(this,b))}"string"==typeof b&&a.isFunction(c=g[b])&&(e=c.apply(g,f))}),c(e)?this:e},a.fn.cropper.Constructor=k,a.fn.cropper.setDefaults=k.setDefaults,a.fn.cropper.noConflict=function(){return a.fn.cropper=k.other,this}}),function(){var a,b,c,d,e,f,g,h,i=[].slice,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=function(){},b=function(){function a(){}return a.prototype.addEventListener=a.prototype.on,a.prototype.on=function(a,b){return this._callbacks=this._callbacks||{},this._callbacks[a]||(this._callbacks[a]=[]),this._callbacks[a].push(b),this},a.prototype.emit=function(){var a,b,c,d,e,f;if(d=arguments[0],a=2<=arguments.length?i.call(arguments,1):[],this._callbacks=this._callbacks||{},c=this._callbacks[d])for(e=0,f=c.length;f>e;e++)b=c[e],b.apply(this,a);return this},a.prototype.removeListener=a.prototype.off,a.prototype.removeAllListeners=a.prototype.off,a.prototype.removeEventListener=a.prototype.off,a.prototype.off=function(a,b){var c,d,e,f,g;if(!this._callbacks||0===arguments.length)return this._callbacks={},this;if(d=this._callbacks[a],!d)return this;if(1===arguments.length)return delete this._callbacks[a],this;for(e=f=0,g=d.length;g>f;e=++f)if(c=d[e],c===b){d.splice(e,1);break}return this},a}(),a=function(a){function c(a,b){var e,f,g;if(this.element=a,this.version=c.version,this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,""),this.clickableElements=[],this.listeners=[],this.files=[],"string"==typeof this.element&&(this.element=document.querySelector(this.element)),!this.element||null==this.element.nodeType)throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("Dropzone already attached.");if(c.instances.push(this),this.element.dropzone=this,e=null!=(g=c.optionsForElement(this.element))?g:{},this.options=d({},this.defaultOptions,e,null!=b?b:{}),this.options.forceFallback||!c.isBrowserSupported())return this.options.fallback.call(this);if(null==this.options.url&&(this.options.url=this.element.getAttribute("action")),!this.options.url)throw new Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");this.options.acceptedMimeTypes&&(this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes),"undefined"==typeof this.options.realname&&(this.options.realname=!1),this.options.method=this.options.method.toUpperCase(),(f=this.getExistingFallback())&&f.parentNode&&f.parentNode.removeChild(f),this.options.previewsContainer!==!1&&(this.options.previewsContainer?this.previewsContainer=c.getElement(this.options.previewsContainer,"previewsContainer"):this.previewsContainer=this.element),this.options.clickable&&(this.options.clickable===!0?this.clickableElements=[this.element]:this.clickableElements=c.getElements(this.options.clickable,"clickable")),this.init()}var d,e;return k(c,a),c.prototype.Emitter=b,c.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"],c.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,filesizeBase:1e3,maxFiles:null,filesizeBase:1e3,params:{},clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,multipartUpload:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,capture:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File size is too big ({{filesize}}MiB). Please load less than {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(a,b){return b()},init:function(){return g},forceFallback:!1,fallback:function(){var a,b,d,e,f,g;for(this.element.className=""+this.element.className+" dz-browser-not-supported",g=this.element.getElementsByTagName("div"),e=0,f=g.length;f>e;e++)a=g[e],/(^| )dz-message($| )/.test(a.className)&&(b=a,a.className="dz-message");return b||(b=c.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(b)),d=b.getElementsByTagName("span")[0],d&&(d.textContent=this.options.dictFallbackMessage),this.element.appendChild(this.getFallbackForm())},resize:function(a){var b,c,d;return b={srcX:0,srcY:0,srcWidth:a.width,srcHeight:a.height},c=a.width/a.height,b.optWidth=this.options.thumbnailWidth,b.optHeight=this.options.thumbnailHeight,null==b.optWidth&&null==b.optHeight?(b.optWidth=b.srcWidth,b.optHeight=b.srcHeight):null==b.optWidth?b.optWidth=c*b.optHeight:null==b.optHeight&&(b.optHeight=1/c*b.optWidth),d=b.optWidth/b.optHeight,a.height<b.optHeight||a.width<b.optWidth?(b.trgHeight=b.srcHeight,b.trgWidth=b.srcWidth):c>d?(b.srcHeight=a.height,b.srcWidth=b.srcHeight*d):(b.srcWidth=a.width,b.srcHeight=b.srcWidth/d),b.srcX=(a.width-b.srcWidth)/2,b.srcY=(a.height-b.srcHeight)/2,b},drop:function(a){return this.element.classList.remove("dz-drag-hover")},dragstart:g,dragend:function(a){return this.element.classList.remove("dz-drag-hover")},dragenter:function(a){return this.element.classList.add("dz-drag-hover")},dragover:function(a){return this.element.classList.add("dz-drag-hover")},dragleave:function(a){return this.element.classList.remove("dz-drag-hover")},paste:g,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(a){var b,d,e,f,g,h,i,j,k,l,m,n,o;if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer){for(a.previewElement=c.createElement(this.options.previewTemplate.trim()),a.previewTemplate=a.previewElement,this.previewsContainer.appendChild(a.previewElement),l=a.previewElement.querySelectorAll("[data-dz-name]"),f=0,i=l.length;i>f;f++)b=l[f],b.textContent=a.name;for(m=a.previewElement.querySelectorAll("[data-dz-size]"),g=0,j=m.length;j>g;g++)b=m[g],b.innerHTML=this.filesize(a.size);for(this.options.addRemoveLinks&&(a._removeLink=c.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),a.previewElement.appendChild(a._removeLink)),d=function(b){return function(d){return d.preventDefault(),d.stopPropagation(),a.status===c.UPLOADING?c.confirm(b.options.dictCancelUploadConfirmation,function(){return b.removeFile(a)}):b.options.dictRemoveFileConfirmation?c.confirm(b.options.dictRemoveFileConfirmation,function(){return b.removeFile(a)}):b.removeFile(a)}}(this),n=a.previewElement.querySelectorAll("[data-dz-remove]"),o=[],h=0,k=n.length;k>h;h++)e=n[h],o.push(e.addEventListener("click",d));return o}},removedfile:function(a){var b;return a.previewElement&&null!=(b=a.previewElement)&&b.parentNode.removeChild(a.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(a,b){var c,d,e,f;if(a.previewElement){for(a.previewElement.classList.remove("dz-file-preview"),f=a.previewElement.querySelectorAll("[data-dz-thumbnail]"),d=0,e=f.length;e>d;d++)c=f[d],c.alt=a.name,c.src=b;return setTimeout(function(b){return function(){return a.previewElement.classList.add("dz-image-preview")}}(this),1)}},error:function(a,b,c){var d,e,f,g,h;if(a.previewElement){for(a.previewElement.classList.add("dz-error"),"String"!=typeof b&&b.error&&(b=b.error),g=a.previewElement.querySelectorAll("[data-dz-errormessage]"),h=[],e=0,f=g.length;f>e;e++)d=g[e],h.push(d.textContent=b);return h}},errormultiple:g,processing:function(a){return a.previewElement&&(a.previewElement.classList.add("dz-processing"),a._removeLink)?a._removeLink.textContent=this.options.dictCancelUpload:void 0},processingmultiple:g,uploadprogress:function(a,b,c){var d,e,f,g,h;if(a.previewElement){for(g=a.previewElement.querySelectorAll("[data-dz-uploadprogress]"),h=[],e=0,f=g.length;f>e;e++)d=g[e],"PROGRESS"===d.nodeName?h.push(d.value=b):h.push(d.style.width=""+b+"%");return h}},totaluploadprogress:g,sending:g,sendingmultiple:g,success:function(a){return a.previewElement?a.previewElement.classList.add("dz-success"):void 0},successmultiple:g,canceled:function(a){return this.emit("error",a,"Upload canceled.")},canceledmultiple:g,complete:function(a){return a._removeLink&&(a._removeLink.textContent=this.options.dictRemoveFile),a.previewElement?a.previewElement.classList.add("dz-complete"):void 0},completemultiple:g,maxfilesexceeded:g,maxfilesreached:g,queuecomplete:g,previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-image"><img data-dz-thumbnail /></div>\n  <div class="dz-details">\n    <div class="dz-size"><span data-dz-size></span></div>\n    <div class="dz-filename"><span data-dz-name></span></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-success-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Check</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <path d="M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" stroke-opacity="0.198794158" stroke="#747474" fill-opacity="0.816519475" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>\n      </g>\n    </svg>\n  </div>\n  <div class="dz-error-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Error</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <g id="Check-+-Oval-2" sketch:type="MSLayerGroup" stroke="#747474" stroke-opacity="0.198794158" fill="#FFFFFF" fill-opacity="0.816519475">\n          <path d="M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" sketch:type="MSShapeGroup"></path>\n        </g>\n      </g>\n    </svg>\n  </div>\n</div>'},d=function(){var a,b,c,d,e,f,g;for(d=arguments[0],c=2<=arguments.length?i.call(arguments,1):[],f=0,g=c.length;g>f;f++){b=c[f];for(a in b)e=b[a],d[a]=e}return d},c.prototype.getAcceptedFiles=function(){var a,b,c,d,e;for(d=this.files,e=[],b=0,c=d.length;c>b;b++)a=d[b],a.accepted&&e.push(a);return e},c.prototype.getRejectedFiles=function(){var a,b,c,d,e;for(d=this.files,e=[],b=0,c=d.length;c>b;b++)a=d[b],a.accepted||e.push(a);return e},c.prototype.getFilesWithStatus=function(a){var b,c,d,e,f;for(e=this.files,f=[],c=0,d=e.length;d>c;c++)b=e[c],b.status===a&&f.push(b);return f},c.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(c.QUEUED)},c.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(c.UPLOADING)},c.prototype.getActiveFiles=function(){var a,b,d,e,f;for(e=this.files,f=[],b=0,d=e.length;d>b;b++)a=e[b],(a.status===c.UPLOADING||a.status===c.QUEUED)&&f.push(a);return f},c.prototype.init=function(){var a,b,d,e,f,g,h;for("form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(c.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&(d=function(a){return function(){return a.hiddenFileInput&&document.body.removeChild(a.hiddenFileInput),a.hiddenFileInput=document.createElement("input"),a.hiddenFileInput.setAttribute("type","file"),(null==a.options.maxFiles||a.options.maxFiles>1)&&a.hiddenFileInput.setAttribute("multiple","multiple"),a.hiddenFileInput.className="dz-hidden-input",null!=a.options.acceptedFiles&&a.hiddenFileInput.setAttribute("accept",a.options.acceptedFiles),null!=a.options.capture&&a.hiddenFileInput.setAttribute("capture",a.options.capture),a.hiddenFileInput.style.visibility="hidden",a.hiddenFileInput.style.position="absolute",a.hiddenFileInput.style.top="0",a.hiddenFileInput.style.left="0",a.hiddenFileInput.style.height="0",a.hiddenFileInput.style.width="0",document.body.appendChild(a.hiddenFileInput),a.hiddenFileInput.addEventListener("change",function(){a.previewsContainer.innerHTML="";var b,c,e,f;if(c=a.hiddenFileInput.files,c.length)for(e=0,f=c.length;f>e;e++)b=c[e],a.addFile(b);return d()})}}(this))(),this.URL=null!=(g=window.URL)?g:window.webkitURL,h=this.events,e=0,f=h.length;f>e;e++)a=h[e],this.on(a,this.options[a]);return this.on("uploadprogress",function(a){return function(){return a.updateTotalUploadProgress()}}(this)),this.on("removedfile",function(a){return function(){return a.updateTotalUploadProgress()}}(this)),this.on("canceled",function(a){return function(b){return a.emit("complete",b)}}(this)),this.on("complete",function(a){return function(b){return 0===a.getUploadingFiles().length&&0===a.getQueuedFiles().length?setTimeout(function(){return a.emit("queuecomplete")},0):void 0}}(this)),b=function(a){return a.stopPropagation(),a.preventDefault?a.preventDefault():a.returnValue=!1},this.listeners=[{element:this.element,events:{dragstart:function(a){return function(b){return a.emit("dragstart",b)}}(this),dragenter:function(a){return function(c){return b(c),a.emit("dragenter",c)}}(this),dragover:function(a){return function(c){var d;try{d=c.dataTransfer.effectAllowed}catch(e){}return c.dataTransfer.dropEffect="move"===d||"linkMove"===d?"move":"copy",b(c),a.emit("dragover",c)}}(this),dragleave:function(a){return function(b){return a.emit("dragleave",b)}}(this),drop:function(a){return function(c){return b(c),a.drop(c)}}(this),dragend:function(a){return function(b){return a.emit("dragend",b)}}(this)}}],this.clickableElements.forEach(function(a){return function(b){return a.listeners.push({element:b,events:{click:function(d){return b!==a.element||d.target===a.element||c.elementInside(d.target,a.element.querySelector(".dz-message"))?a.hiddenFileInput.click():void 0}}})}}(this)),this.enable(),this.options.init.call(this)},c.prototype.destroy=function(){var a;return this.disable(),this.removeAllFiles(!0),(null!=(a=this.hiddenFileInput)?a.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,c.instances.splice(c.instances.indexOf(this),1)},c.prototype.updateTotalUploadProgress=function(){var a,b,c,d,e,f,g,h;if(d=0,c=0,a=this.getActiveFiles(),a.length){for(h=this.getActiveFiles(),f=0,g=h.length;g>f;f++)b=h[f],d+=b.upload.bytesSent,c+=b.upload.total;e=100*d/c}else e=100;return this.emit("totaluploadprogress",e,c,d)},c.prototype._getParamName=function(a){return"function"==typeof this.options.paramName?this.options.paramName(a):""+this.options.paramName+(this.options.uploadMultiple?"["+a+"]":"")},c.prototype.getFallbackForm=function(){var a,b,d,e;return(a=this.getExistingFallback())?a:(d='<div class="dz-fallback">',this.options.dictFallbackText&&(d+="<p>"+this.options.dictFallbackText+"</p>"),d+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>',b=c.createElement(d),"FORM"!==this.element.tagName?(e=c.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>'),e.appendChild(b)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=e?e:b)},c.prototype.getExistingFallback=function(){var a,b,c,d,e,f;for(b=function(a){var b,c,d;for(c=0,d=a.length;d>c;c++)if(b=a[c],/(^| )fallback($| )/.test(b.className))return b},f=["div","form"],d=0,e=f.length;e>d;d++)if(c=f[d],a=b(this.element.getElementsByTagName(c)))return a},c.prototype.setupEventListeners=function(){var a,b,c,d,e,f,g;for(f=this.listeners,g=[],d=0,e=f.length;e>d;d++)a=f[d],g.push(function(){var d,e;d=a.events,e=[];for(b in d)c=d[b],e.push(a.element.addEventListener(b,c,!1));return e}());return g},c.prototype.removeEventListeners=function(){var a,b,c,d,e,f,g;for(f=this.listeners,g=[],d=0,e=f.length;e>d;d++)a=f[d],g.push(function(){var d,e;d=a.events,e=[];for(b in d)c=d[b],e.push(a.element.removeEventListener(b,c,!1));return e}());return g},c.prototype.disable=function(){var a,b,c,d,e;for(this.clickableElements.forEach(function(a){
return a.classList.remove("dz-clickable")}),this.removeEventListeners(),d=this.files,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(this.cancelUpload(a));return e},c.prototype.enable=function(){return this.clickableElements.forEach(function(a){return a.classList.add("dz-clickable")}),this.setupEventListeners()},c.prototype.filesize=function(a){var b,c,d,e,f,g,h,i;for(g=["TB","GB","MB","KB","b"],d=e=null,c=h=0,i=g.length;i>h;c=++h)if(f=g[c],b=Math.pow(this.options.filesizeBase,4-c)/10,a>=b){d=a/Math.pow(this.options.filesizeBase,4-c),e=f;break}return d=Math.round(10*d)/10,"<strong>"+d+"</strong> "+e},c.prototype._updateMaxFilesReachedClass=function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")},c.prototype.drop=function(a){var b,c;a.dataTransfer&&(this.emit("drop",a),this.previewsContainer.innerHTML="",b=a.dataTransfer.files,b.length&&(c=a.dataTransfer.items,c&&c.length&&null!=c[0].webkitGetAsEntry?this._addFilesFromItems(c):this.handleFiles(b)))},c.prototype.paste=function(a){var b,c;if(null!=(null!=a&&null!=(c=a.clipboardData)?c.items:void 0))return this.emit("paste",a),b=a.clipboardData.items,b.length?this._addFilesFromItems(b):void 0},c.prototype.handleFiles=function(a){var b,c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(this.addFile(b));return e},c.prototype._addFilesFromItems=function(a){var b,c,d,e,f;for(f=[],d=0,e=a.length;e>d;d++)c=a[d],null!=c.webkitGetAsEntry&&(b=c.webkitGetAsEntry())?b.isFile?f.push(this.addFile(c.getAsFile())):b.isDirectory?f.push(this._addFilesFromDirectory(b,b.name)):f.push(void 0):null!=c.getAsFile&&(null==c.kind||"file"===c.kind)?f.push(this.addFile(c.getAsFile())):f.push(void 0);return f},c.prototype._addFilesFromDirectory=function(a,b){var c,d;return c=a.createReader(),d=function(a){return function(c){var d,e,f;for(e=0,f=c.length;f>e;e++)d=c[e],d.isFile?d.file(function(c){return a.options.ignoreHiddenFiles&&"."===c.name.substring(0,1)?void 0:(c.fullPath=""+b+"/"+c.name,a.addFile(c))}):d.isDirectory&&a._addFilesFromDirectory(d,""+b+"/"+d.name)}}(this),c.readEntries(d,function(a){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log(a):void 0})},c.prototype.accept=function(a,b){var d=new RegExp("^[a-zA-Z0-9-_ ]+([.]?[a-zA-Z0-9]+)?$");return d.test(a.name)?a.size>1024*this.options.maxFilesize*1024?b(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(a.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):c.isValidFile(a,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(b(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",a)):this.options.accept.call(this,a,b):b(this.options.dictInvalidFileType):b("Please provide vaild file name. Please remove white spaces and special characters.")},c.prototype.addFile=function(a){a.upload={progress:0,total:a.size,bytesSent:0},this.files.push(a);var b=$("#total-upload-items");return b.length&&b.html(this.files.length),a.status=c.ADDED,this.emit("addedfile",a),this._enqueueThumbnail(a),this.accept(a,function(b){return function(c){return c?(a.accepted=!1,b._errorProcessing([a],c)):(a.accepted=!0,b.options.autoQueue&&b.enqueueFile(a)),b._updateMaxFilesReachedClass()}}(this))},c.prototype.enqueueFiles=function(a){var b,c,d;for(c=0,d=a.length;d>c;c++)b=a[c],this.enqueueFile(b);return null},c.prototype.enqueueFile=function(a){if(a.status!==c.ADDED||a.accepted!==!0)throw new Error("This file can't be queued because it has already been processed or was rejected.");return a.status=c.QUEUED,this.options.autoProcessQueue?setTimeout(function(a){return function(){return a.processQueue()}}(this),0):void 0},c.prototype._thumbnailQueue=[],c.prototype._processingThumbnail=!1,c.prototype._enqueueThumbnail=function(a){return this.options.createImageThumbnails&&a.type.match(/image.*/)&&a.size<=1024*this.options.maxThumbnailFilesize*1024?(this._thumbnailQueue.push(a),setTimeout(function(a){return function(){return a._processThumbnailQueue()}}(this),0)):void 0},c.prototype._processThumbnailQueue=function(){return this._processingThumbnail||0===this._thumbnailQueue.length?void 0:(this._processingThumbnail=!0,this.createThumbnail(this._thumbnailQueue.shift(),function(a){return function(){return a._processingThumbnail=!1,a._processThumbnailQueue()}}(this)))},c.prototype.removeFile=function(a){return a.status===c.UPLOADING&&this.cancelUpload(a),this.files=h(this.files,a),this.emit("removedfile",a),0===this.files.length?this.emit("reset"):void 0},c.prototype.removeAllFiles=function(a){var b,d,e,f;for(null==a&&(a=!1),f=this.files.slice(),d=0,e=f.length;e>d;d++)b=f[d],(b.status!==c.UPLOADING||a)&&this.removeFile(b);return null},c.prototype.createThumbnail=function(a,b){var c;return c=new FileReader,c.onload=function(d){return function(){return"image/svg+xml"===a.type?(d.emit("thumbnail",a,c.result),void(null!=b&&b())):d.createThumbnailFromUrl(a,c.result,b)}}(this),c.readAsDataURL(a)},c.prototype.createThumbnailFromUrl=function(a,b,c){var d;return d=document.createElement("img"),d.onload=function(b){return function(){var e,g,h,i,j,k,l,m;return a.width=d.width,a.height=d.height,h=b.options.resize.call(b,a),null==h.trgWidth&&(h.trgWidth=h.optWidth),null==h.trgHeight&&(h.trgHeight=h.optHeight),e=document.createElement("canvas"),g=e.getContext("2d"),e.width=h.trgWidth,e.height=h.trgHeight,f(g,d,null!=(j=h.srcX)?j:0,null!=(k=h.srcY)?k:0,h.srcWidth,h.srcHeight,null!=(l=h.trgX)?l:0,null!=(m=h.trgY)?m:0,h.trgWidth,h.trgHeight),i=e.toDataURL("image/png"),b.emit("thumbnail",a,i),null!=c?c():void 0}}(this),null!=c&&(d.onerror=c),d.src=b},c.prototype.processQueue=function(){var a,b,c,d;if(b=this.options.parallelUploads,c=this.getUploadingFiles().length,a=c,!(c>=b)&&(d=this.getQueuedFiles(),d.length>0)){if(this.options.uploadMultiple)return this.processFiles(d.slice(0,b-c));for(;b>a;){if(!d.length)return;this.processFile(d.shift()),a++}}},c.prototype.processFile=function(a){return this.processFiles([a])},c.prototype.processFiles=function(a){var b,d,e;for(d=0,e=a.length;e>d;d++)b=a[d],b.processing=!0,b.status=c.UPLOADING,this.emit("processing",b);return this.options.uploadMultiple&&this.emit("processingmultiple",a),0==this.options.multipartUpload||1==this.options.uploadMultiple?this.uploadFiles(a):this.chunkedUploadFiles(a)},c.prototype._getFilesWithXhr=function(a){var b,c;return c=function(){var c,d,e,f;for(e=this.files,f=[],c=0,d=e.length;d>c;c++)b=e[c],b.xhr===a&&f.push(b);return f}.call(this)},c.prototype.cancelUpload=function(a){var b,d,e,f,g,h,i;if(a.status===c.UPLOADING){for(d=this._getFilesWithXhr(a.xhr),e=0,g=d.length;g>e;e++)b=d[e],b.status=c.CANCELED;for(a.xhr.abort(),f=0,h=d.length;h>f;f++)b=d[f],this.emit("canceled",b);this.options.uploadMultiple&&this.emit("canceledmultiple",d)}else((i=a.status)===c.ADDED||i===c.QUEUED)&&(a.status=c.CANCELED,this.emit("canceled",a),this.options.uploadMultiple&&this.emit("canceledmultiple",[a]));return this.options.autoProcessQueue?this.processQueue():void 0},e=function(){var a,b;return b=arguments[0],a=2<=arguments.length?i.call(arguments,1):[],"function"==typeof b?b.apply(this,a):b},c.prototype.uploadFile=function(a){return 0==this.options.multipartUpload||1==this.options.uploadMultiple?this.uploadFiles([a]):this.chunkedUploadFiles([a])},c.prototype.uploadFiles=function(a){var b,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L;for(w=new XMLHttpRequest,x=0,B=a.length;B>x;x++)b.chunkedUpload=!1,b=a[x],b.xhr=w;p=e(this.options.method,a),u=e(this.options.url,a),w.open(p,u,!0),w.withCredentials=!!this.options.withCredentials,s=null,g=function(c){return function(){var d,e,f;for(f=[],d=0,e=a.length;e>d;d++)b=a[d],f.push(c._errorProcessing(a,s||c.options.dictResponseError.replace("{{statusCode}}",w.status),w));return f}}(this),t=function(c){return function(d){var e,f,g,h,i,j,k,l,m;if(null!=d)for(f=100*d.loaded/d.total,g=0,j=a.length;j>g;g++)b=a[g],b.upload={progress:f,total:d.total,bytesSent:d.loaded};else{for(e=!0,f=100,h=0,k=a.length;k>h;h++)b=a[h],(100!==b.upload.progress||b.upload.bytesSent!==b.upload.total)&&(e=!1),b.upload.progress=f,b.upload.bytesSent=b.upload.total;if(e)return}for(m=[],i=0,l=a.length;l>i;i++)b=a[i],m.push(c.emit("uploadprogress",b,f,b.upload.bytesSent));return m}}(this),w.onload=function(b){return function(d){var e;if(a[0].status!==c.CANCELED&&4===w.readyState){if(s=w.responseText,w.getResponseHeader("content-type")&&~w.getResponseHeader("content-type").indexOf("application/json"))try{s=JSON.parse(s)}catch(f){d=f,s="Invalid JSON response from server."}return t(),200<=(e=w.status)&&300>e?b._finished(a,s,d):g()}}}(this),w.onerror=function(b){return function(){return a[0].status!==c.CANCELED?g():void 0}}(this),r=null!=(G=w.upload)?G:w,r.onprogress=t,j={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"},this.options.headers&&d(j,this.options.headers);for(h in j)i=j[h],w.setRequestHeader(h,i);if(f=new FormData,this.options.params){H=this.options.params;for(o in H)v=H[o],f.append(o,v)}for(y=0,C=a.length;C>y;y++)b=a[y],this.emit("sending",b,w,f);if(this.options.uploadMultiple&&this.emit("sendingmultiple",a,w,f),"FORM"===this.element.tagName)for(I=this.element.querySelectorAll("input, textarea, select, button"),z=0,D=I.length;D>z;z++)if(l=I[z],m=l.getAttribute("name"),n=l.getAttribute("type"),"SELECT"===l.tagName&&l.hasAttribute("multiple"))for(J=l.options,A=0,E=J.length;E>A;A++)q=J[A],q.selected&&f.append(m,q.value);else(!n||"checkbox"!==(K=n.toLowerCase())&&"radio"!==K||l.checked)&&f.append(m,l.value);for(k=F=0,L=a.length-1;L>=0?L>=F:F>=L;k=L>=0?++F:--F)f.append(this._getParamName(k),a[k],a[k].name);return w.send(f)},c.prototype.chunkedUploadFiles=function(a){var b,d;b=a[0],b.chunkedUpload=!0,b.xhr=void 0,uploadComplete=function(c){return function(){progress=100,b=a[0],b.upload.progress=progress,b.upload.bytesSent=b.upload.total,c.emit("uploadprogress",b,progress,b.upload.bytesSent),c._finished(a,"Successfully uploaded",void 0)}}(this),d=function(c){return function(d,e){progress=100*d/e,b=a[0],b.upload={progress:progress,total:e,bytesSent:d},c.emit("uploadprogress",b,progress,b.upload.bytesSent)}}(this),uploaderror=function(b){return function(d,e){a[0].status!==c.CANCELED&&b._errorProcessing(a,d,e)}}(this);this.options.uploadFileName?b.currFileName=this.options.uploadFileName:b.currFileName=b.name;var e=b.currFileName.substring(0,b.currFileName.lastIndexOf("."));e=e.replace(/[^a-zA-Z0-9]/g,"_");var f=b.currFileName.substring(b.currFileName.lastIndexOf(".")+1);b.currFileName=e+"_"+Math.random().toString(36).substring(7)+"."+f,this.options.realname&&(b.currFileName=b.name),this.options.appAssetsfileName&&(b.currFileName=this.options.appAssetsfileName+"."+f);var g="private";this.options.permissions==MediaManager.permission.PUBLIC_READ&&(g="public-read");var h=new Evaporate({aws_key:"AKIAYZVDBV46I7OOVQVX",bucket:this.options.bucket,lrToken:this.options.lrToken,filePermission:g,urlParams:this.options.urlParams});h.add({uploadPath:this.options.uploadPath,name:b.currFileName,file:b,notSignedHeadersAtInitiate:{"Cache-Control":"max-age=1552000"},xAmzHeadersAtInitiate:{"x-amz-acl":g},xAmzHeadersAtUpload:{},xAmzHeadersAtComplete:{},complete:uploadComplete,progress:d,error:uploaderror}),this.emit("sending",b,void 0,void 0)},c.prototype._finished=function(a,b,d){var e,f,g;for(f=0,g=a.length;g>f;f++)e=a[f],e.status=c.SUCCESS,this.emit("success",e,b,d),this.emit("complete",e);return this.options.uploadMultiple&&(this.emit("successmultiple",a,b,d),this.emit("completemultiple",a)),this.options.autoProcessQueue?this.processQueue():void 0},c.prototype._errorProcessing=function(a,b,d){var e,f,g;for(f=0,g=a.length;g>f;f++)e=a[f],e.status=c.ERROR,this.emit("error",e,b,d),this.emit("complete",e);return this.options.uploadMultiple&&(this.emit("errormultiple",a,b,d),this.emit("completemultiple",a)),this.options.autoProcessQueue?this.processQueue():void 0},c}(b),a.version="4.0.1",a.options={},a.optionsForElement=function(b){return b.getAttribute("id")?a.options[c(b.getAttribute("id"))]:void 0},a.instances=[],a.forElement=function(a){if("string"==typeof a&&(a=document.querySelector(a)),null==(null!=a?a.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return a.dropzone},a.autoDiscover=!0,a.discover=function(){var b,c,d,e,f,g;for(document.querySelectorAll?d=document.querySelectorAll(".dropzone"):(d=[],b=function(a){var b,c,e,f;for(f=[],c=0,e=a.length;e>c;c++)b=a[c],/(^| )dropzone($| )/.test(b.className)?f.push(d.push(b)):f.push(void 0);return f},b(document.getElementsByTagName("div")),b(document.getElementsByTagName("form"))),g=[],e=0,f=d.length;f>e;e++)c=d[e],a.optionsForElement(c)!==!1?g.push(new a(c)):g.push(void 0);return g},a.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i],a.isBrowserSupported=function(){var b,c,d,e,f;if(b=!0,window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(f=a.blacklistedBrowsers,d=0,e=f.length;e>d;d++)c=f[d],c.test(navigator.userAgent)&&(b=!1);else b=!1;else b=!1;return b},h=function(a,b){var c,d,e,f;for(f=[],d=0,e=a.length;e>d;d++)c=a[d],c!==b&&f.push(c);return f},c=function(a){return a.replace(/[\-_](\w)/g,function(a){return a.charAt(1).toUpperCase()})},a.createElement=function(a){var b;return b=document.createElement("div"),b.innerHTML=a,b.childNodes[0]},a.elementInside=function(a,b){if(a===b)return!0;for(;a=a.parentNode;)if(a===b)return!0;return!1},a.getElement=function(a,b){var c;if("string"==typeof a?c=document.querySelector(a):null!=a.nodeType&&(c=a),null==c)throw new Error("Invalid `"+b+"` option provided. Please provide a CSS selector or a plain HTML element.");return c},a.getElements=function(a,b){var c,d,e,f,g,h,i,j;if(a instanceof Array){e=[];try{for(f=0,h=a.length;h>f;f++)d=a[f],e.push(this.getElement(d,b))}catch(k){c=k,e=null}}else if("string"==typeof a)for(e=[],j=document.querySelectorAll(a),g=0,i=j.length;i>g;g++)d=j[g],e.push(d);else null!=a.nodeType&&(e=[a]);if(null==e||!e.length)throw new Error("Invalid `"+b+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return e},a.confirm=function(a,b,c){return window.confirm(a)?b():null!=c?c():void 0},a.isValidFile=function(a,b){var c,d,e,f,g;if(!b)return!0;for(b=b.split(","),d=a.type,c=d.replace(/\/.*$/,""),f=0,g=b.length;g>f;f++)if(e=b[f],e=e.trim(),"."===e.charAt(0)){if(-1!==a.name.toLowerCase().indexOf(e.toLowerCase(),a.name.length-e.length))return!0}else if(/\/\*$/.test(e)){if(c===e.replace(/\/.*$/,""))return!0}else if(d===e)return!0;return!1},"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery.fn.dropzone=function(b){return this.each(function(){return new a(this,b)})}),"undefined"!=typeof module&&null!==module?module.exports=a:window.Dropzone=a,a.ADDED="added",a.QUEUED="queued",a.ACCEPTED=a.QUEUED,a.UPLOADING="uploading",a.PROCESSING=a.UPLOADING,a.CANCELED="canceled",a.ERROR="error",a.SUCCESS="success",e=function(a){var b,c,d,e,f,g,h,i,j,k;for(h=a.naturalWidth,g=a.naturalHeight,c=document.createElement("canvas"),c.width=1,c.height=g,d=c.getContext("2d"),d.drawImage(a,0,0),e=d.getImageData(0,0,1,g).data,k=0,f=g,i=g;i>k;)b=e[4*(i-1)+3],0===b?f=i:k=i,i=f+k>>1;return j=i/g,0===j?1:j},f=function(a,b,c,d,f,g,h,i,j,k){var l;return l=e(b),a.drawImage(b,c,d,f,g,h,i,j,k/l)},d=function(a,b){var c,d,e,f,g,h,i,j,k;if(e=!1,k=!0,d=a.document,j=d.documentElement,c=d.addEventListener?"addEventListener":"attachEvent",i=d.addEventListener?"removeEventListener":"detachEvent",h=d.addEventListener?"":"on",f=function(c){return"readystatechange"!==c.type||"complete"===d.readyState?(("load"===c.type?a:d)[i](h+c.type,f,!1),!e&&(e=!0)?b.call(a,c.type||c):void 0):void 0},g=function(){var a;try{j.doScroll("left")}catch(b){return a=b,void setTimeout(g,50)}return f("poll")},"complete"!==d.readyState){if(d.createEventObject&&j.doScroll){try{k=!a.frameElement}catch(l){}k&&g()}return d[c](h+"DOMContentLoaded",f,!1),d[c](h+"readystatechange",f,!1),a[c](h+"load",f,!1)}},a._autoDiscoverFunction=function(){return a.autoDiscover?a.discover():void 0},d(window,a._autoDiscoverFunction)}.call(this),this.JST=this.JST||{},this.JST["cropper.hbs"]=Handlebars.template({1:function(a,b,c,d,e){var f,g;return'\n                            <button class="btn btn-primary" data-method="setAspectRatio" data-option="'+(null!=(g=null!=(g=c.aspectRatio||(null!=b?b.aspectRatio:b))?g:c.helperMissing,f="function"==typeof g?g.call(null!=b?b:a.nullContext||{},{name:"aspectRatio",hash:{},data:e}):g)?f:"")+'" type="button" title="Set Aspect Ratio">\n                                <span class="docs-tooltip" data-toggle="tooltip" title="Fixed aspect ratio">\n                                <span class="icon icon-lock"></span>\n                                </span>\n                            </button>\n\n                            <button class="btn btn-primary" data-method="setAspectRatio" data-option="NaN" type="button" title="Set Aspect Ratio">\n                                <span class="docs-tooltip" data-toggle="tooltip" title="Free aspect ratio">\n                                <span class="icon icon-unlock"></span>\n                                </span>\n                            </button>\n                            '},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:a.nullContext||{},i=c.helperMissing,j="function";return'<!--Cropper Modal -->\n<!--<div class="modal-body cropper-view" style="background: #1b232c">-->\n<div class="container-fluid">\n    <div class="row ">\n        <div>\n            <div id="learnyst-cropper-holder" style="min-height: 360px; max-height: 360px;">\n                <div id="learnyst-cropper-image"><img crossorigin="anonymous" src="'+(null!=(g=null!=(g=c.imgUrl||(null!=b?b.imgUrl:b))?g:i,f=typeof g===j?g.call(h,{name:"imgUrl",hash:{},data:e}):g)?f:"")+'" style="height: 360px; width:'+(null!=(g=null!=(g=c.maxImgWidth||(null!=b?b.maxImgWidth:b))?g:i,f=typeof g===j?g.call(h,{name:"maxImgWidth",hash:{},data:e}):g)?f:"")+'px; display:block;" id="cropper_target"></div>\n            </div>\n            <div class="row" style="margin-top: 10px;">\n                <div style=" margin: 0px auto; margin-left: auto;margin-right: auto;text-align: center;">\n                    <div class="docs-buttons">\n                        <!-- <h3 class="page-header">Toolbar:</h3> -->\n                        <div class="btn-group">\n                            <button class="btn btn-primary" data-method="setDragMode" data-option="move" type="button" title="Move">\n                                <span class="docs-tooltip" data-toggle="tooltip" title="Move Image">\n                                <span class="icon icon-move"></span>\n                                </span>\n                            </button>\n                            <button class="btn btn-primary" data-method="zoom" data-option="0.1" type="button" title="Zoom In">\n                                <span class="docs-tooltip" data-toggle="tooltip" title="Zoom-In">\n                                <span class="icon icon-zoom-in"></span>\n                                </span>\n                            </button>\n                            <button class="btn btn-primary" data-method="zoom" data-option="-0.1" type="button" title="Zoom Out">\n                                <span class="docs-tooltip" data-toggle="tooltip" title="Zoom-Out">\n                                <span class="icon icon-zoom-out"></span>\n                                </span>\n                            </button>\n                            <button class="btn btn-primary" data-method="rotate" data-option="-45" type="button" title="Rotate Left">\n                                <span class="docs-tooltip" data-toggle="tooltip" title="Rotate Left">\n                                <span class="icon icon-rotate-left"></span>\n                                </span>\n                            </button>\n                            <button class="btn btn-primary" data-method="rotate" data-option="45" type="button" title="Rotate Right">\n                                <span class="docs-tooltip" data-toggle="tooltip" title="Rotate Right">\n                                <span class="icon icon-rotate-right"></span>\n                                </span>\n                            </button>\n                            <button class="btn btn-primary" data-method="reset" type="button" title="Reset">\n                                <span class="docs-tooltip" data-toggle="tooltip" title="Reset">\n                                <span class="icon icon-refresh"></span>\n                                </span>\n                            </button>\n\n                            <!-- '+(null!=(f=c["if"].call(h,null!=b?b.cropperFreeAspectRatio:b,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+" -->\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n        "},useData:!0}),this.JST["cropperTab.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<div class="modal-body" style="padding:0px">\n  <div class="modal-footer" style="border-top:0px;">\n  </div>\n</div>\n\n'},useData:!0}),this.JST["embedFileTab.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<div class="modal-body" style="padding:0px">\n    <div class="row" style="background-color: #F6F8FA;">\n        <div id="embedfilesview" style="min-height: 390px; max-height: 390px;">\n            <div class="embed-container" style="background-color: #FFFFFF; min-height: 380px; max-height: 380px;">\n                <div style="margin-top: 100px;">\n                    <div style="margin-left: auto; margin-right: auto; text-align: center; margin-top: 10px;">\n                        <span class=\'upload-embed-icon\'></span>\n                    </div>\n                    <div style="margin-top:15px;width: 60%;margin-left: auto;margin-right: auto;">\n                        <div class="input-group" id="embedForm">\n                            <span class="input-group-addon" style="color:#02962c;font-weight:bold;font-size:16px;">Url</span>\n                            <input type="text" id="embedUrl" class="form-control" placeholder="youtube or vimeo or dacast url">\n                            <span class="input-group-btn">\n                                 <button type="button" class="btn btn-primary btn-videoembed">Embed</button>\n                            </span>\n                        </div>\n                    </div>\n                    <div id="embedUrl-help-msg" style="text-align: center; font-size: 14px; padding-bottom: 10px; color: #0087F7;"> We support <b>Youtube</b>, <b>Vimeo</b> and <b>Dacast</b> video embeds\n                    </div>\n                    <div id="embedUrl-error-msg" style="text-align: center; font-size: 14px; padding-bottom: 10px; color: #F56161; display: none;">\n                    <b>Error:</b> Invalid URL, Please enter a valid embed URL.\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="modal-footer" style="border-top:0px;">\n        <button type="button" class="btn btn-success btn-upload" data-dismiss="modal">Close</button>\n    </div>\n</div>\n'},useData:!0}),this.JST["libImagesTab.hbs"]=Handlebars.template({1:function(a,b,c,d,e){return"            <h1> Loading ... </h1> \n            "},3:function(a,b,c,d,e){var f,g=null!=b?b:a.nullContext||{};return' \n            <div class="learnyst-library-header">\n                <ul>\n'+(null!=(f=c.each.call(g,null!=b?b.headerImages:b,{name:"each",hash:{},fn:a.program(4,e,0),inverse:a.noop,data:e}))?f:"")+'                </ul>\n            </div>\n            <div id="mm_image_list" class="lib_img_scroll" style="padding: 0px 15px; min-height: 310px; max-height: 310px;">\n                <ul>\n'+(null!=(f=c.each.call(g,null!=b?b.images:b,{name:"each",hash:{},fn:a.program(6,e,0),inverse:a.noop,data:e}))?f:"")+"                </ul>\n            </div>\n"},4:function(a,b,c,d,e){var f,g=null!=b?b:a.nullContext||{},h=c.helperMissing,i="function",j=a.escapeExpression;return'                    <li>\n                        <img type="image" id="'+j((f=null!=(f=c.main_type||(null!=b?b.main_type:b))?f:h,typeof f===i?f.call(g,{name:"main_type",hash:{},data:e}):f))+"_"+j((f=null!=(f=c.sub_type||(null!=b?b.sub_type:b))?f:h,typeof f===i?f.call(g,{name:"sub_type",hash:{},data:e}):f))+'" data-main-type="'+j((f=null!=(f=c.main_type||(null!=b?b.main_type:b))?f:h,typeof f===i?f.call(g,{name:"main_type",hash:{},data:e}):f))+'" data-sub-type="'+j((f=null!=(f=c.sub_type||(null!=b?b.sub_type:b))?f:h,typeof f===i?f.call(g,{name:"sub_type",hash:{},data:e}):f))+'" src="'+j((f=null!=(f=c.image||(null!=b?b.image:b))?f:h,typeof f===i?f.call(g,{name:"image",hash:{},data:e}):f))+'" class="groupIcon" style="  max-width: 80px; max-height: 80px; outline: none; margin: 10px 6px; background-color: #303030;" />\n                    </li>\n'},6:function(a,b,c,d,e){var f;return null!=(f=c["if"].call(null!=b?b:a.nullContext||{},null!=b?b.resource_folder_url:b,{name:"if",hash:{},fn:a.program(7,e,0),inverse:a.noop,data:e}))?f:""},7:function(a,b,c,d,e){var f,g=null!=b?b:a.nullContext||{},h=c.helperMissing,i="function",j=a.escapeExpression;return'                            <li id="imgSelected_'+j((f=null!=(f=c.id||(null!=b?b.id:b))?f:h,typeof f===i?f.call(g,{name:"id",hash:{},data:e}):f))+'" class="imgList">\n                                <img type="image" data-img-id="'+j((f=null!=(f=c.id||(null!=b?b.id:b))?f:h,typeof f===i?f.call(g,{name:"id",hash:{},data:e}):f))+'" data-src="'+j((f=null!=(f=c.resource_folder_url||(null!=b?b.resource_folder_url:b))?f:h,typeof f===i?f.call(g,{name:"resource_folder_url",hash:{},data:e}):f))+'" class="imgBorder player-loader-icon" style="" />\n                            </li>\n'},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f;return'<div class="modal-body" style="padding:0px">\n    <div class="row" style="background-color: #F6F8FA;">\n        <div id="libImageList" class="col-md-12" style="padding: 0px; overflow-y:scroll;">\n'+(null!=(f=(c.ifcond||b&&b.ifcond||c.helperMissing).call(null!=b?b:a.nullContext||{},null!=b?b.imgCount:b,"==","0",{name:"ifcond",hash:{},fn:a.program(1,e,0),inverse:a.program(3,e,0),data:e}))?f:"")+'        </div>\n    \n    </div>\n\n    <div class="modal-footer" style="border-top:0px;">\n        <button type="button" class="btn btn-success btn-upload" id="libImageSelect">Select</button>\n        <button type="button" class="btn btn-success btn-upload" data-dismiss="modal">Close</button>\n    </div>\n</div>\n'},useData:!0}),this.JST["mediaManager.hbs"]=Handlebars.template({1:function(a,b,c,d,e){return'                        <li role="presentation" class="active" id="js-upload-file"><a href="#upload-file" aria-controls="upload-file" role="tab" data-toggle="tab"><span class="tab-links">Upload</span></a></li>\n'},3:function(a,b,c,d,e){return'                        <li role="presentation" id="js-user-img"><a href="#user-images" aria-controls="user-images" role="tab" data-toggle="tab"><span class="tab-links">Your Images</span></a></li>\n'},5:function(a,b,c,d,e){return'                        <li role="presentation" id="js-learnyst-icons"><a href="#learnyst-icons" aria-controls="learnyst-icons" role="tab" data-toggle="tab"><span class="tab-links">Icon Library</span></a></li>\n'},7:function(a,b,c,d,e){return'                        <li role="presentation" id="js-learnyst-bgimages"><a href="#learnyst-bgimages" aria-controls="learnyst-bgimages" role="tab" data-toggle="tab"><span class="tab-links">Image Library</span></a></li>\n'},9:function(a,b,c,d,e){return'                        <li role="presentation" id="js-image-cropper"><a href="#image-cropper" aria-controls="learnyst-cropper" role="tab" data-toggle="tab"><span class="tab-links">Cropper</span></a></li>\n'},11:function(a,b,c,d,e){return'                        <li role="presentation" id="js-video-embed"><a href="#video-embed" aria-controls="video-embed" role="tab" data-toggle="tab"><span class="tab-links">Embed files</span></a></li> \n'},13:function(a,b,c,d,e){return'                        <li role="presentation" id="js-file-sync"><a href="#file-sync" aria-controls="file-sync" role="tab" data-toggle="tab"><span class="tab-links">Sync Files</span></a></li> \n'},15:function(a,b,c,d,e){return'                        <div role="tabpanel" class="tab-pane active" id="upload-file"></div>\n'},17:function(a,b,c,d,e){return'                        <div role="tabpanel" class="tab-pane" id="user-images"></div>\n'},19:function(a,b,c,d,e){return'                        <div role="tabpanel" class="tab-pane" id="learnyst-icons"></div>\n'},21:function(a,b,c,d,e){return'                        <div role="tabpanel" class="tab-pane" id="learnyst-bgimages"></div>\n'},23:function(a,b,c,d,e){return'                        <div role="tabpanel" class="tab-pane" id="image-cropper"></div>\n'},25:function(a,b,c,d,e){return'                        <div role="tabpanel" class="tab-pane" id="video-embed"></div>\n'},27:function(a,b,c,d,e){return'                        <div role="tabpanel" class="tab-pane" id="file-sync"></div>\n'},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=null!=b?b:a.nullContext||{};return'<div class="modal fade" id="mediaManagerModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="z-index: 9999;">\n    <div class="modal-dialog" style="width:900px; z-index: 9999;">\n        <div class="modal-content">\n            <div class="modal-header" style="border-bottom:0px;padding: 0px 15px;">\n                <button type="button" class="close multi-upload-close" data-dismiss="modal" aria-label="Close" style="margin: 10px 15px 0 0;"><span aria-hidden="true">&times;</span></button>\n                <div role="tabpanel">\n                    <!-- Nav tabs -->\n                    <ul class="nav nav-tabs custom" role="tablist" style="border-bottom:0px;margin-top:20px">\n'+(null!=(f=c["if"].call(g,null!=b?b.showUpload:b,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+"\n"+(null!=(f=c["if"].call(g,null!=b?b.showUserImages:b,{name:"if",hash:{},fn:a.program(3,e,0),inverse:a.noop,data:e}))?f:"")+"\n"+(null!=(f=c["if"].call(g,null!=b?b.showLearnystIcons:b,{name:"if",hash:{},fn:a.program(5,e,0),inverse:a.noop,data:e}))?f:"")+"\n"+(null!=(f=c["if"].call(g,null!=b?b.showLearnystBgImages:b,{name:"if",hash:{},fn:a.program(7,e,0),inverse:a.noop,data:e}))?f:"")+"\n"+(null!=(f=c["if"].call(g,null!=b?b.showCropper:b,{name:"if",hash:{},fn:a.program(9,e,0),inverse:a.noop,data:e}))?f:"")+"\n"+(null!=(f=c["if"].call(g,null!=b?b.showVideoEmbed:b,{name:"if",hash:{},fn:a.program(11,e,0),inverse:a.noop,data:e}))?f:"")+"\n"+(null!=(f=c["if"].call(g,null!=b?b.showFileSync:b,{name:"if",hash:{},fn:a.program(13,e,0),inverse:a.noop,data:e}))?f:"")+'\n                    </ul>\n                    <!-- Tab panes -->\n                    <div class="tab-content">\n'+(null!=(f=c["if"].call(g,null!=b?b.showUpload:b,{name:"if",hash:{},fn:a.program(15,e,0),inverse:a.noop,data:e}))?f:"")+"\n"+(null!=(f=c["if"].call(g,null!=b?b.showUserImages:b,{name:"if",hash:{},fn:a.program(17,e,0),inverse:a.noop,data:e}))?f:"")+"\n"+(null!=(f=c["if"].call(g,null!=b?b.showLearnystIcons:b,{
name:"if",hash:{},fn:a.program(19,e,0),inverse:a.noop,data:e}))?f:"")+"\n\n"+(null!=(f=c["if"].call(g,null!=b?b.showLearnystBgImages:b,{name:"if",hash:{},fn:a.program(21,e,0),inverse:a.noop,data:e}))?f:"")+"\n"+(null!=(f=c["if"].call(g,null!=b?b.showCropper:b,{name:"if",hash:{},fn:a.program(23,e,0),inverse:a.noop,data:e}))?f:"")+"\n"+(null!=(f=c["if"].call(g,null!=b?b.showVideoEmbed:b,{name:"if",hash:{},fn:a.program(25,e,0),inverse:a.noop,data:e}))?f:"")+"\n"+(null!=(f=c["if"].call(g,null!=b?b.showFileSync:b,{name:"if",hash:{},fn:a.program(27,e,0),inverse:a.noop,data:e}))?f:"")+"                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n"},useData:!0}),this.JST["syncFileTab.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<div class="modal-body" style="padding:0px">\n    <div class="row" style="background-color: #F6F8FA;">\n        <div id="embedfilesview" style="min-height: 390px; max-height: 390px;">\n            <div class="embed-container" style="background-color: #FFFFFF; min-height: 380px; max-height: 380px;">\n                <div style="margin-top: 100px;">\n                    <div style="margin-left: auto; margin-right: auto; text-align: center; margin-top: 10px;">\n                        <span class=\'upload-dropbox-icon\' style="padding:14px 0 0px 0px;"></span>\n                    </div>\n                    <div style="margin-top:15px;width: 60%;margin-left: auto;margin-right: auto;">\n                        <div style="margin-left: auto; margin-right: auto; display: block; text-align: center;">\n                            <button type="button" class="btn btn-primary btn-dropboxsync" style="cursor: pointer;">Choose files from Dropbox</button>\n                        </div>\n                    </div>\n                    <div style="text-align: center; font-size: 14px; padding-bottom: 10px; color: #0087F7;"> Sync files from <b>Dropbox\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="modal-footer" style="border-top:0px;">\n        <button type="button" class="btn btn-success btn-upload" data-dismiss="modal">Close</button>\n    </div>\n</div>\n'},useData:!0}),this.JST["uploadFileTab.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<div class="modal-body" style="padding:0px">\n\n  <div class="row dropzone-view" style="background-color: #F6F8FA;">\n    <div style="padding:15px">\n      <div id="dropzone" style="min-height: 340px; max-height: 340px; position: relative;">\n        <div id="media-uploader" class="media-container dropzone" style="background-color: #FFFFFF; min-height: 340px; max-height: 340px;">\n          <div class="dz-message" style="margin-top:30px;display: block;margin-left: auto;margin-right: auto;text-align: center;">\n            <p style="font-weight:900;color:#898c91;font-size:36px">Drag & drop<br />file</p>\n            <p style="font-weight:400;color:#898c91;font-size:16px">OR</p>\n            <button type="button" class="btn btn-primary btn-selectImg" style="cursor: pointer;">Select file from your computer</button>\n          </div>\n          <div class="load-img-error" style="margin-top:30px;display: block;margin-left: auto;margin-right: auto;text-align: center; display:none;">\n            <p style="color: red; font-size: 16px;">Failed to load image for cropping. </p>\n            <br />\n            <p style="color: blue; font-size: 18px;">Click here to browse image from your drive and crop image.</p>\n          </div>\n          <div id="dropzone-previews" style="display: block; margin-left: auto; margin-right: auto; text-align: center; overflow-y: scroll; max-height:225px"> </div>\n        </div>\n        <div class="uploadLoadingView overlay-spinner" style="display: none;">\n          <div style="margin-top: 160px; margin-left: auto; margin-right: auto; display: block; text-align: center; position: relative;">\n            <span class="player-loader-icon"></span>\n            <p style="color: blue; font-size: 18px;">Loading please wait</p>\n          </div>\n        </div>\n      </div>\n      <div id="upload-item-status" style="display: none;">\n          <div style="margin-top: 10px;">\n            <div style="margin-left: auto; margin-right: auto; text-align: center; margin-top: 10px;">\n                <span class="status-icon" style="max-width: 20px;"></span>\n                <p>Upload complete status: <span id="current-item">0</span> of <span id="total-upload-items"></span></p>\n            </div>\n          </div>\n      </div>\n       <div id="operation-status" style="display: none;">\n            <div style="margin-top: 10px;">\n              <div style="margin-left: auto; margin-right: auto; text-align: center; margin-top: 10px;">\n                  <span class="status-icon" style="max-width: 20px;"></span>\n                  <a id="operation-status-popover" href="javascript:void(0)" role="button" class="btn popovers" data-toggle="popover" >Click here for last upload status / Click again to close</a>\n              </div>\n            </div>\n        </div>\n    </div>\n  </div>\n\n  <div class="cropper-view" style="background: #1b232c"> </div>\n\n  <div class="modal-footer" style="border-top:0px;">\n    <button type="button" class="btn btn-success btn-upload save-cropped-img-button" style="display:none" id="cropperSaveButton">Save Cropped Image</button>\n    <button type="button" class="btn btn-success btn-upload skip-cropped-img-button" style="display:none" id="cropperSkipButton">Skip cropping</button>\n    <button type="button" class="btn btn-success btn-upload multi-upload-close" data-dismiss="modal" >Close</button>\n  </div>\n</div>\n\n\n'},useData:!0}),this.JST["userImagesTab.hbs"]=Handlebars.template({1:function(a,b,c,d,e){return'          <h1> Loading ... </h1>\n          <span class="empty-image-icon" style="padding: 54px 0 20px 15px;"></span>\n          <p class="emptyTab">You have no image uploaded<br> in the gallery.</p>\n          <p class="emptyTab">Please browse from your gallery and upload here</p>\n'},3:function(a,b,c,d,e){var f;return'        <ul>\n          <p class="browselib">Browse from the already uploaded gallery</p>\n'+(null!=(f=c.each.call(null!=b?b:a.nullContext||{},null!=b?b.medias:b,{name:"each",hash:{},fn:a.program(4,e,0),inverse:a.noop,data:e}))?f:"")+"        </ul>\n"},4:function(a,b,c,d,e){var f;return null!=(f=c["if"].call(null!=b?b:a.nullContext||{},null!=b?b.resource_folder_url:b,{name:"if",hash:{},fn:a.program(5,e,0),inverse:a.noop,data:e}))?f:""},5:function(a,b,c,d,e){var f,g=null!=b?b:a.nullContext||{},h=c.helperMissing,i="function",j=a.escapeExpression;return'              <li id="imgSelected_'+j((f=null!=(f=c.index||e&&e.index)?f:h,typeof f===i?f.call(g,{name:"index",hash:{},data:e}):f))+'" class="imgList">\n                <img type="image" data-img-id="'+j((f=null!=(f=c.index||e&&e.index)?f:h,typeof f===i?f.call(g,{name:"index",hash:{},data:e}):f))+'" data-src="'+j((f=null!=(f=c.resource_folder_url||(null!=b?b.resource_folder_url:b))?f:h,typeof f===i?f.call(g,{name:"resource_folder_url",hash:{},data:e}):f))+'" class="imgBorder player-loader-icon" style=""/>\n              </li>\n'},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f;return'<div class="modal-body" style="padding:0px">\n  <div class="row" style="background-color: #F6F8FA;">\n    <div class="col-md-12">\n\n      <div id="mm_image_list" class="user_img_scroll" style="min-height: 390px; max-height: 390px; overflow-y:scroll;">\n\n'+(null!=(f=(c.ifcond||b&&b.ifcond||c.helperMissing).call(null!=b?b:a.nullContext||{},null!=b?b.imgCount:b,"==","0",{name:"ifcond",hash:{},fn:a.program(1,e,0),inverse:a.program(3,e,0),data:e}))?f:"")+'      </div>\n      <br>\n    </div>\n  </div>\n  <div class="modal-footer" style="border-top:0px;">\n\n    <button type="button" class="btn btn-success btn-upload" id="userImageSelect">Select</button>\n    <button type="button" class="btn btn-success btn-upload" data-dismiss="modal" >Close</button>\n  </div>\n</div>\n\n'},useData:!0}),window.LstMediaManager={Models:{},Collections:{},Views:{}};var MediaManager=function(){var a=null;return{getInstance:function(){return null===a&&(a=new LstMediaManager.Views.MediaManagerView({el:$("#mediaManagerV1")})),a},fileType:{LEARNYST_FILE:0,YOUTUBE:1,VIMEO:2,DACAST:3,DROPBOX:4},permission:{PRIVATE:0,PUBLIC_READ:1}}}();!function(a){"use strict";Backbone.View.prototype.close=function(){console.error("Remove view"),this.remove(),this.onClose&&(console.error("Called onClose"),this.onClose())}}(jQuery),function(a){a.fn.unveil=function(b,c){function d(){var b=j.filter(function(){var b=a(this);if(!b.is(":hidden")){var c=f.scrollTop(),d=c+f.height(),e=b.offset().top,h=e+b.height();return h>=c-g&&d+g>=e}});e=b.trigger("unveil"),j=j.not(e)}var e,f=a(window),g=b||0,h=window.devicePixelRatio>1,i=h?"data-src-retina":"data-src",j=this;return a(window).off("unveil"),this.one("unveil",function(){var a=this.getAttribute(i);a=a||this.getAttribute("data-src"),a&&(this.setAttribute("src",a),this.removeAttribute("data-src"),this.classList.remove("player-loader-icon"),"function"==typeof c&&c.call(this))}),d(),{unveilNow:function(){d()}}}}(window.jQuery||window.Zepto);var Base64Binary={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decodeArrayBuffer:function(a){var b=a.length/4*3,c=new ArrayBuffer(b);return this.decode(a,c),c},removePaddingChars:function(a){var b=this._keyStr.indexOf(a.charAt(a.length-1));return 64==b?a.substring(0,a.length-1):a},decode:function(a,b){a=this.removePaddingChars(a),a=this.removePaddingChars(a);var c,d,e,f,g,h,i,j,k=parseInt(a.length/4*3,10),l=0,m=0;for(c=b?new Uint8Array(b):new Uint8Array(k),a=a.replace(/[^A-Za-z0-9\+\/\=]/g,""),l=0;k>l;l+=3)g=this._keyStr.indexOf(a.charAt(m++)),h=this._keyStr.indexOf(a.charAt(m++)),i=this._keyStr.indexOf(a.charAt(m++)),j=this._keyStr.indexOf(a.charAt(m++)),d=g<<2|h>>4,e=(15&h)<<4|i>>2,f=(3&i)<<6|j,c[l]=d,64!=i&&(c[l+1]=e),64!=j&&(c[l+2]=f);return c}};LstMediaManager.Models=LstMediaManager.Models||{},function(){"use strict";LstMediaManager.Models.LearnystMedia=Backbone.Model.extend({})}(),LstMediaManager.Models=LstMediaManager.Models||{},function(){"use strict";LstMediaManager.Models.LearnystBackground=Backbone.Model.extend({name:"background"})}(),LstMediaManager.Models=LstMediaManager.Models||{},function(){"use strict";LstMediaManager.Models.LearnystIcon=Backbone.Model.extend({name:"icon"})}(),LstMediaManager.Models=LstMediaManager.Models||{},function(){"use strict";LstMediaManager.Models.Media=Backbone.Model.extend({})}(),LstMediaManager.Models=LstMediaManager.Models||{},function(){"use strict";LstMediaManager.Models.Lesson=Backbone.Model.extend({name:"lesson",initialize:function(a){this.lessonId=a.lessonId},url:function(){return"https://api.learnyst.com/admin/v4/lessons/"+this.lessonId}})}(),LstMediaManager.Models=LstMediaManager.Models||{},function(){"use strict";LstMediaManager.Models.Element=Backbone.Model.extend({})}(),LstMediaManager.Collections=LstMediaManager.Collections||{},function(){"use strict";LstMediaManager.Collections.LearnystMedias=Backbone.Collection.extend({name:"learnystMedias",initialize:function(a){},url:function(){return"https://api.learnyst.com/admin/v4/site_resources?is_admin=1"},model:LstMediaManager.Models.LearnystMedia,parse:function(a){return _.has(a,"backgrounds")&&(this.backgrounds=new LstMediaManager.Collections.LearnystBackgrounds(a,{parse:!0}),delete a.backgrounds),_.has(a,"icons")&&(this.icons=new LstMediaManager.Collections.LearnystIcons(a,{parse:!0}),delete a.icons),a.images}})}(),LstMediaManager.Collections=LstMediaManager.Collections||{},function(){"use strict";LstMediaManager.Collections.LearnystBackgrounds=Backbone.Collection.extend({name:"backgrounds",model:LstMediaManager.Models.LearnystBackground,parse:function(a){return JSON.parse(a.backgrounds)}})}(),LstMediaManager.Collections=LstMediaManager.Collections||{},function(){"use strict";LstMediaManager.Collections.LearnystIcons=Backbone.Collection.extend({name:"icons",model:LstMediaManager.Models.LearnystIcon,parse:function(a){return JSON.parse(a.icons)}})}(),LstMediaManager.Collections=LstMediaManager.Collections||{},function(){"use strict";LstMediaManager.Collections.Medias=Backbone.Collection.extend({initialize:function(a){this.fetchUrl=a.fetchUrl},url:function(){return this.fetchUrl},model:LstMediaManager.Models.Media,parse:function(a){return a.images}})}(),LstMediaManager.Collections=LstMediaManager.Collections||{},function(){"use strict";LstMediaManager.Collections.Lessons=Backbone.Collection.extend({name:"lessons",url:"https://api.learnyst.com/admin/v4/lessons",model:LstMediaManager.Models.Lesson})}(),LstMediaManager.Collections=LstMediaManager.Collections||{},function(){"use strict";LstMediaManager.Collections.Elements=Backbone.Collection.extend({model:LstMediaManager.Models.Element})}(),LstMediaManager.Views=LstMediaManager.Views||{},function(){"use strict";LstMediaManager.Views.MediaManagerView=Backbone.View.extend({tagName:"div",mediaTpl:JST["mediaManager.hbs"],userImagesTabView:null,learnystBgImagesTabView:null,learnystIconsTabView:null,uploadFileTabView:null,imageCropperTabView:null,videoEmbedTabView:null,fileSyncTabView:null,setOptions:function(a){console.debug("Setting mediamanager options"),this.lrToken=a.lrToken,this.showFileUpload=a.showFileUpload,this.showLearnystBgImages=a.showLearnystBgImages,this.showLearnystIcons=a.showLearnystIcons,this.showUserImages=a.showUserImages,this.showImageCropper=a.showImageCropper,this.showVideoEmbed=a.showVideoEmbed,this.showFileSync=a.showFileSync,this.fileUploadBucket=a.fileUploadBucket,this.fileUploadAppType=a.fileUploadAppType,this.fileUploadPath=a.fileUploadPath,this.uploadFileName=a.uploadFileName,this.realname=a.realname,this.writeUserimageRecordToServer=a.writeUserimageRecordToServer,this.writeUserimageServerParams=a.writeUserimageServerParams,this.uploadFileTypes=a.uploadFileTypes,this.userImageFetchUrl=a.userImageFetchUrl,this.userImageWriteUrl=a.userImageWriteUrl,this.singleFileUpload=a.singleFileUpload,this.mandateImageCrop=a.mandateImageCrop,this.cropImageUrl=a.cropImageUrl,this.adaptCropperConfig(a.cropTypeConfig),this.imageListCallback=a.imageListCallback,this.permissions=a.permissions,this.appAssetsfileName=a.appAssetsfileName,this.urlParams=a.urlParams,this.fileSizeLimit=a.fileSizeLimit,this.showStatus=a.showStatus,void 0==this.showFileUpload&&(this.showFileUpload=!1),void 0==this.showLearnystBgImages&&(this.showLearnystBgImages=!1),void 0==this.showLearnystIcons&&(this.showLearnystIcons=!1),void 0==this.showUserImages&&(this.showUserImages=!1),void 0==this.showImageCropper&&(this.showImageCropper=!1),void 0==this.showVideoEmbed&&(this.showVideoEmbed=!1),void 0==this.mandateImageCrop&&(this.mandateImageCrop=!1),void 0==this.singleFileUpload&&(this.singleFileUpload=!1),void 0==this.cropperMaintainAspectRatio&&(this.cropperMaintainAspectRatio=!1),void 0==this.writeUserimageRecordToServer&&(this.writeUserimageRecordToServer=!1),void 0==this.cropperFixedType&&(this.cropperFixedType=!1),void 0==this.showFileSync&&(this.showFileSync=!1),void 0==this.permissions&&(this.permissions=MediaManager.permission.PRIVATE),void 0==this.showStatus&&(this.showStatus=!1),1==this.showFileUpload&&((void 0==this.fileUploadBucket||this.fileUploadBucket.trim().length<=0)&&(this.showFileUpload=!1,console.error("Bucket details required for FileUpload tab. Not showing upload tab")),(void 0==this.fileUploadPath||this.fileUploadPath.trim().length<=0)&&(this.showFileUpload=!1,console.error("fileUploadPath details required for FileUpload tab. Not showing upload tab"))),1==this.showImageCropper&&((void 0==this.fileUploadBucket||this.fileUploadBucket.trim().length<=0)&&(this.showImageCropper=!1,console.error("fileUploadBucket required for image cropper. Not showing cropper")),(void 0==this.fileUploadPath||this.fileUploadPath.trim().length<=0)&&(this.showImageCropper=!1,console.error("fileUploadPath details required for image cropper. Not showing upload tab")),(void 0==this.cropImageUrl||this.cropImageUrl.trim().length<=0)&&(this.showImageCropper=!1,console.error("Cropper Image URL required for image cropper. Not showing cropper"))),1==this.showUserImages&&(void 0==this.userImageFetchUrl||this.userImageFetchUrl.trim().length<=0)&&(this.showUserImages=!1,console.error("User image fetchurl required for showing user images.")),1==this.cropperMaintainAspectRatio?(void 0==this.cropperAspectRatioWidth||void 0==this.cropperAspectRatioHeight)&&(this.cropperMaintainAspectRatio=!1,console.error("Aspectratio width and height missing. Not maintaining aspect ratio.")):(void 0==this.cropperAspectRatioWidth||void 0==this.cropperAspectRatioHeight)&&(this.cropperMaintainAspectRatio=!1,this.cropperAspectRatioWidth=1,this.cropperAspectRatioHeight=1),1==this.cropperFixedType&&(void 0==this.cropFixedWidth||void 0==this.cropFixedHeight)&&(this.cropperFixedType=!1,console.error("Fixed width and height missing. Not maintaining fixed type.")),(void 0==this.uploadFileTypes||this.uploadFileTypes.trim().length<=0)&&(this.uploadFileTypes="*/*"),1==this.mandateImageCrop&&(this.uploadFileTypes="image/*",1!=this.singleFileUpload&&(this.singleFileUpload=!0,console.error("Multifile upload not supported during image crop. Making single file upload")),(void 0==this.fileUploadBucket||this.fileUploadBucket.trim().length<=0)&&(this.mandateImageCrop=!1,console.error("fileUploadBucket required for image cropper. not mandating image crop")),(void 0==this.fileUploadPath||this.fileUploadPath.trim().length<=0)&&(this.mandateImageCrop=!1,console.error("fileUploadPath details required for image cropper. Not showing upload tab"))),1==this.writeUserimageRecordToServer&&(void 0==this.userImageWriteUrl||null==this.userImageWriteUrl)&&(this.writeUserimageRecordToServer=!1,console.error("userImageWriteUrl details required for for writing image record to server. Not writing details to server"))},modifyOptions:function(a){console.debug("modifyOptions called"),a.hasOwnProperty("showFileUpload")&&(this.showFileUpload=a.showFileUpload),a.hasOwnProperty("showLearnystBgImages")&&(this.showLearnystBgImages=a.showLearnystBgImages),a.hasOwnProperty("showLearnystIcons")&&(this.showLearnystIcons=a.showLearnystIcons),a.hasOwnProperty("showUserImages")&&(this.showUserImages=a.showUserImages),a.hasOwnProperty("showImageCropper")&&(this.showImageCropper=a.showImageCropper),a.hasOwnProperty("showVideoEmbed")&&(this.showVideoEmbed=a.showVideoEmbed),a.hasOwnProperty("showFileSync")&&(this.showFileSync=a.showFileSync),a.hasOwnProperty("fileUploadBucket")&&(this.fileUploadBucket=a.fileUploadBucket),a.hasOwnProperty("fileUploadAppType")&&(this.fileUploadAppType=a.fileUploadAppType),a.hasOwnProperty("fileUploadPath")&&(this.fileUploadPath=a.fileUploadPath),a.hasOwnProperty("uploadFileName")&&(this.uploadFileName=a.uploadFileName),a.hasOwnProperty("realname")&&(this.realname=a.realname),a.hasOwnProperty("writeUserimageRecordToServer")&&(this.writeUserimageRecordToServer=a.writeUserimageRecordToServer),a.hasOwnProperty("writeUserimageServerParams")&&(this.writeUserimageServerParams=a.writeUserimageServerParams),a.hasOwnProperty("uploadFileTypes")&&(this.uploadFileTypes=a.uploadFileTypes),a.hasOwnProperty("userImageFetchUrl")&&(this.userImageFetchUrl=a.userImageFetchUrl),a.hasOwnProperty("userImageWriteUrl")&&(this.userImageWriteUrl=a.userImageWriteUrl),a.hasOwnProperty("singleFileUpload")&&(this.singleFileUpload=a.singleFileUpload),a.hasOwnProperty("mandateImageCrop")&&(this.mandateImageCrop=a.mandateImageCrop),a.hasOwnProperty("cropImageUrl")&&(this.cropImageUrl=a.cropImageUrl),a.hasOwnProperty("cropTypeConfig")&&this.adaptCropperConfig(a.cropTypeConfig),a.hasOwnProperty("imageListCallback")&&(this.imageListCallback=a.imageListCallback),a.hasOwnProperty("permissions")&&(this.permissions=a.permissions),a.hasOwnProperty("showStatus")&&(this.showStatus=a.showStatus)},adaptCropperConfig:function(a){"undefined"!=typeof a&&(a.hasOwnProperty("cropType")?"aspectratio"==a.cropType?(this.cropperMaintainAspectRatio=!0,this.cropperAspectRatioWidth=a.cropperAspectRatioWidth,this.cropperAspectRatioHeight=a.cropperAspectRatioHeight,a.hasOwnProperty("minWidth")&&(this.cropperMinWidth=a.minWidth),a.hasOwnProperty("minHeight")&&(this.cropperMinHeight=a.minHeight),this.cropperFixedType=!1,this.cropFixedWidth=-1,this.cropFixedHeight=-1):"free"==a.cropType?(this.cropperMaintainAspectRatio=!1,this.cropperAspectRatioWidth=a.cropperAspectRatioWidth,this.cropperAspectRatioHeight=a.cropperAspectRatioHeight,a.hasOwnProperty("minWidth")&&(this.cropperMinWidth=a.minWidth),a.hasOwnProperty("minHeight")&&(this.cropperMinHeight=a.minHeight),this.cropperFixedType=!1,this.cropFixedWidth=-1,this.cropFixedHeight=-1):"fixed"==a.cropType&&(this.cropperFixedType=!0,this.cropFixedWidth=a.fixedWidth,this.cropFixedHeight=a.fixedHeight,this.cropperMaintainAspectRatio=!1,this.cropperAspectRatioWidth=-1,this.cropperAspectRatioHeight=-1,this.cropperMinWidth=-1,this.cropperMinHeight=-1):console.debug("cropper data not provided properly"))},show:function(){console.debug("Showing Media manager"),this.userFileList=[];var a=this;this.render(),this.modalEl.modal({show:!0,backdrop:"static",keyboard:!1}),this.$('a[data-toggle="tab"]').on("shown.bs.tab",function(b){var c=b.target.attributes.href.value;"#upload-file"==c&&a.uploadFileTabView&&a.uploadFileTabView.onFocus&&a.uploadFileTabView.onFocus(),"#user-images"==c&&a.userImagesTabView&&a.userImagesTabView.onFocus&&a.userImagesTabView.onFocus(),"#learnyst-bgimages"==c&&a.learnystBgImagesTabView&&a.learnystBgImagesTabView.onFocus&&a.learnystBgImagesTabView.onFocus(),"#learnyst-icons"==c&&a.learnystIconsTabView&&a.learnystIconsTabView.onFocus&&a.learnystIconsTabView.onFocus(),"#image-cropper"==c&&a.imageCropperTabView&&a.imageCropperTabView.onFocus&&a.imageCropperTabView.onFocus(),"#video-embed"==c&&a.videoEmbedTabView&&a.videoEmbedTabView.onFocus&&a.videoEmbedTabView.onFocus(),"#file-sync"==c&&a.fileSyncTabView&&a.fileSyncTabView.onFocus&&a.fileSyncTabView.onFocus()}),this.showFileUpload?this.$('.nav-tabs a[href="#upload-file"]').tab("show"):this.showUserImages?this.$('.nav-tabs a[href="#user-images"]').tab("show"):this.showLearnystIcons?this.$('.nav-tabs a[href="#learnyst-icons"]').tab("show"):this.showLearnystBgImages?this.$('.nav-tabs a[href="#learnyst-bgimages"]').tab("show"):this.showImageCropper?this.$('.nav-tabs a[href="#image-cropper"]').tab("show"):this.showVideoEmbed?this.$('.nav-tabs a[href="#video-embed"]').tab("show"):this.showFileSync&&this.$('.nav-tabs a[href="#file-sync"]').tab("show")},hide:function(){console.debug("Hiding Media manager"),this.modalEl.modal("hide")},fetchData:function(){(1==this.showLearnystBgImages||1==this.showLearnystIcons)&&void 0==this.libImgCollection&&(this.libImgCollection=new LstMediaManager.Collections.LearnystMedias,this.libImgCollection.fetch({reset:!0}),this.listenTo(this.libImgCollection,"reset",this.onResetLibImages)),1==this.showUserImages&&void 0==this.userImgCollection&&(this.userImgCollection=new LstMediaManager.Collections.Medias({fetchUrl:this.userImageFetchUrl}),this.userImgCollection.fetch({reset:!0}),this.listenTo(this.userImgCollection,"reset",this.onResetUserImages),this.listenTo(this.userImgCollection,"add",this.onAddUserImages))},render:function(){console.debug("Render Media manager"),this.fetchData(),null!=this.uploadFileTabView&&(this.uploadFileTabView.close(),this.uploadFileTabView=null),null!=this.userImagesTabView&&(this.userImagesTabView.close(),this.userImagesTabView=null),null!=this.learnystBgImagesTabView&&(this.learnystBgImagesTabView.close(),this.learnystBgImagesTabView=null),null!=this.learnystIconsTabView&&(this.learnystIconsTabView.close(),this.learnystIconsTabView=null),null!=this.imageCropperTabView&&(this.imageCropperTabView.close(),this.imageCropperTabView=null),null!=this.videoEmbedTabView&&(this.videoEmbedTabView.close(),this.videoEmbedTabView=null),null!=this.fileSyncTabView&&(this.fileSyncTabView.close(),this.fileSyncTabView=null),this.$el.html(this.mediaTpl({showUpload:this.showFileUpload,showUserImages:this.showUserImages,showLearnystIcons:this.showLearnystIcons,showLearnystBgImages:this.showLearnystBgImages,showCropper:this.showImageCropper,showVideoEmbed:this.showVideoEmbed,showFileSync:this.showFileSync}));var a=null;1==this.showFileUpload&&(null===this.uploadFileTabView&&(a=this.$el.find("#upload-file"),this.uploadFileTabView=new LstMediaManager.Views.UploadFileTabView({el:a,parent:this,lrToken:this.lrToken,fileUploadBucket:this.fileUploadBucket,fileUploadAppType:this.fileUploadAppType,fileUploadPath:this.fileUploadPath,uploadFileName:this.uploadFileName,realname:this.realname,writeUserimageRecordToServer:this.writeUserimageRecordToServer,writeUserimageServerParams:this.writeUserimageServerParams,acceptedFileTypes:this.uploadFileTypes,mandateImageCrop:this.mandateImageCrop,singleFileUpload:this.singleFileUpload,cropperMaintainAspectRatio:this.cropperMaintainAspectRatio,cropperAspectRatioWidth:this.cropperAspectRatioWidth,cropperAspectRatioHeight:this.cropperAspectRatioHeight,permissions:this.permissions,userImageWriteUrl:this.userImageWriteUrl,cropperFixedType:this.cropperFixedType,cropFixedWidth:this.cropFixedWidth,cropFixedHeight:this.cropFixedHeight,cropperMinWidth:this.cropperMinWidth,cropperMinHeight:this.cropperMinHeight,appAssetsfileName:this.appAssetsfileName,urlParams:this.urlParams,fileSizeLimit:this.fileSizeLimit,showStatus:this.showStatus})),this.uploadFileTabView.render()),1==this.showUserImages&&(null===this.userImagesTabView&&(a=this.$el.find("#user-images"),this.userImagesTabView=new LstMediaManager.Views.UserImageTabView({el:a,parent:this,collection:this.userImgCollection,lrToken:this.lrToken,fileUploadBucket:this.fileUploadBucket,fileUploadAppType:this.fileUploadAppType,fileUploadPath:this.fileUploadPath,uploadFileName:this.uploadFileName,realname:this.realname,writeUserimageRecordToServer:this.writeUserimageRecordToServer,writeUserimageServerParams:this.writeUserimageServerParams,mandateImageCrop:this.mandateImageCrop,singleFileUpload:this.singleFileUpload,cropperMaintainAspectRatio:this.cropperMaintainAspectRatio,cropperAspectRatioWidth:this.cropperAspectRatioWidth,cropperAspectRatioHeight:this.cropperAspectRatioHeight,permissions:this.permissions,userImageWriteUrl:this.userImageWriteUrl,cropperFixedType:this.cropperFixedType,cropFixedWidth:this.cropFixedWidth,cropFixedHeight:this.cropFixedHeight,cropperMinWidth:this.cropperMinWidth,cropperMinHeight:this.cropperMinHeight,showStatus:this.showStatus})),this.userImagesTabView.render()),1==this.showLearnystBgImages&&(null===this.learnystBgImagesTabView&&(a=this.$el.find("#learnyst-bgimages"),this.learnystBgImagesTabView=new LstMediaManager.Views.LibImageTabView({el:a,parent:this,collection:this.libImgCollection,lrToken:this.lrToken,fileUploadBucket:this.fileUploadBucket,fileUploadAppType:this.fileUploadAppType,fileUploadPath:this.fileUploadPath,uploadFileName:this.uploadFileName,realname:this.realname,writeUserimageRecordToServer:this.writeUserimageRecordToServer,writeUserimageServerParams:this.writeUserimageServerParams,mandateImageCrop:this.mandateImageCrop,singleFileUpload:this.singleFileUpload,cropperMaintainAspectRatio:this.cropperMaintainAspectRatio,cropperAspectRatioWidth:this.cropperAspectRatioWidth,cropperAspectRatioHeight:this.cropperAspectRatioHeight,permissions:this.permissions,userImageWriteUrl:this.userImageWriteUrl,cropperFixedType:this.cropperFixedType,cropFixedWidth:this.cropFixedWidth,cropFixedHeight:this.cropFixedHeight,cropperMinWidth:this.cropperMinWidth,cropperMinHeight:this.cropperMinHeight,showStatus:this.showStatus})),this.learnystBgImagesTabView.render("backgrounds")),1==this.showLearnystIcons&&(null===this.learnystIconsTabView&&(a=this.$el.find("#learnyst-icons"),this.learnystIconsTabView=new LstMediaManager.Views.LibImageTabView({el:a,parent:this,collection:this.libImgCollection,lrToken:this.lrToken,fileUploadBucket:this.fileUploadBucket,fileUploadAppType:this.fileUploadAppType,fileUploadPath:this.fileUploadPath,uploadFileName:this.uploadFileName,realname:this.realname,writeUserimageRecordToServer:this.writeUserimageRecordToServer,writeUserimageServerParams:this.writeUserimageServerParams,mandateImageCrop:this.mandateImageCrop,singleFileUpload:this.singleFileUpload,cropperMaintainAspectRatio:this.cropperMaintainAspectRatio,cropperAspectRatioWidth:this.cropperAspectRatioWidth,cropperAspectRatioHeight:this.cropperAspectRatioHeight,permissions:this.permissions,userImageWriteUrl:this.userImageWriteUrl,cropperFixedType:this.cropperFixedType,cropFixedWidth:this.cropFixedWidth,cropFixedHeight:this.cropFixedHeight,cropperMinWidth:this.cropperMinWidth,cropperMinHeight:this.cropperMinHeight,showStatus:this.showStatus})),this.learnystIconsTabView.render("icons")),1==this.showImageCropper&&(null===this.imageCropperTabView&&(a=this.$el.find("#image-cropper"),this.imageCropperTabView=new LstMediaManager.Views.ImageCropperTabView({el:a,parent:this,collection:this.libImgCollection,lrToken:this.lrToken,fileUploadBucket:this.fileUploadBucket,fileUploadAppType:this.fileUploadAppType,fileUploadPath:this.fileUploadPath,uploadFileName:this.uploadFileName,realname:this.realname,writeUserimageRecordToServer:this.writeUserimageRecordToServer,writeUserimageServerParams:this.writeUserimageServerParams,mandateImageCrop:this.mandateImageCrop,singleFileUpload:this.singleFileUpload,cropperMaintainAspectRatio:this.cropperMaintainAspectRatio,cropperAspectRatioWidth:this.cropperAspectRatioWidth,cropperAspectRatioHeight:this.cropperAspectRatioHeight,cropImageUrl:this.cropImageUrl,permissions:this.permissions,userImageWriteUrl:this.userImageWriteUrl,cropperFixedType:this.cropperFixedType,cropFixedWidth:this.cropFixedWidth,cropFixedHeight:this.cropFixedHeight,cropperMinWidth:this.cropperMinWidth,cropperMinHeight:this.cropperMinHeight,showStatus:this.showStatus})),this.imageCropperTabView.render()),1==this.showVideoEmbed&&(null===this.videoEmbedTabView&&(a=this.$el.find("#video-embed"),this.VideoEmbedTabView=new LstMediaManager.Views.VideoEmbedTabView({el:a,parent:this})),this.VideoEmbedTabView.render()),1==this.showFileSync&&(null===this.fileSyncTabView&&(a=this.$el.find("#file-sync"),this.fileSyncTabView=new LstMediaManager.Views.FileSyncTabView({el:a,parent:this,singleFileUpload:this.singleFileUpload,acceptedFileTypes:this.uploadFileTypes})),this.fileSyncTabView.render()),this.modalEl=this.$el.find("#mediaManagerModal");var b=this;return this.modalEl.on("hidden.bs.modal",function(){b.trigger("mediaManagerHide"),b.onMediaManagerClose()}),this},onResetUserImages:function(){this.showUserImages&&this.userImagesTabView.render()},onAddUserImages:function(){this.showUserImages&&this.userImagesTabView.render()},onResetLibImages:function(){this.learnystBgImagesTabView&&this.learnystBgImagesTabView.render("backgrounds"),this.learnystIconsTabView&&this.learnystIconsTabView.render("icons")},onPublishImageUrl:function(a,b,c){var d={filePath:a,fileName:b,type:c};this.userFileList.push(d),console.debug("Media manager uploaded/selected image URL:"+a)},onMediaManagerClose:function(){console.debug("Media manager closed"),this.imageListCallback&&this.imageListCallback(this.userFileList)},handleUploadedFile:function(a,b){if(1==this.writeUserimageRecordToServer){var c=b.substring(b.lastIndexOf(".")+1);if("png"==c||"jpg"==c||"jpeg"==c||"gif"==c||"bmp"==c){var d=new XMLHttpRequest,e='{"lr_token":"'+this.lrToken+'", "filepath" :"'+a+'", "fileName":"'+b+'"';null!=this.writeUserimageServerParams&&void 0!=this.writeUserimageServerParams&&(e+=","+this.writeUserimageServerParams),e+="}",d.onreadystatechange=function(){4==d.readyState&&(200==d.status||console.error("Writing uer image record to server failed "))},d.onerror=function(){console.error("Writing uer image record to server failed ");
},d.open("POST",this.userImageWriteUrl),d.setRequestHeader("Authorization","Bearer "+this.lrToken),d.send(e),void 0!=this.userImgCollection&&this.userImgCollection.add({resource_folder_url:a,resource_file_name:b})}}}})}(),LstMediaManager.Views.UploadFileTabView=Backbone.View.extend({uploadFileTabTpl:JST["uploadFileTab.hbs"],cropperTpl:JST["cropper.hbs"],mydropzone:null,events:{"click #operation-status":"showLastOperationStatus"},initialize:function(a){this.parent=a.parent,this.lrToken=a.lrToken,this.fileUploadBucket=a.fileUploadBucket,this.fileUploadAppType=a.fileUploadAppType,this.fileUploadPath=a.fileUploadPath,this.uploadFileName=a.uploadFileName,this.realname=a.realname,this.writeUserimageServerParams=a.writeUserimageServerParams,this.writeUserimageRecordToServer=a.writeUserimageRecordToServer,this.acceptedFileTypes=a.acceptedFileTypes,this.saveRecordToServer=a.saveRecordToServer,this.mandateImageCrop=a.mandateImageCrop,this.singleFileUpload=a.singleFileUpload,this.cropperMaintainAspectRatio=a.cropperMaintainAspectRatio,this.cropperAspectRatioWidth=a.cropperAspectRatioWidth,this.cropperAspectRatioHeight=a.cropperAspectRatioHeight,this.cropImageUrl=a.cropImageUrl,this.permissions=a.permissions,this.userImageWriteUrl=a.userImageWriteUrl,this.cropperFixedType=a.cropperFixedType,this.cropFixedWidth=a.cropFixedWidth,this.cropFixedHeight=a.cropFixedHeight,this.cropperMinWidth=a.cropperMinWidth,this.cropperMinHeight=a.cropperMinHeight,this.appAssetsfileName=a.appAssetsfileName,this.urlParams=a.urlParams,this.fileSizeLimit=a.fileSizeLimit,this.showStatus=a.showStatus},render:function(){console.debug("Render UploadFileTabView"),this.$el.html(this.uploadFileTabTpl());var a=this,b=!0;return 1==this.mandateImageCrop&&(b=!1),this.mydropzone=new Dropzone(this.$el.find("div#media-uploader").get(0),{url:"http://"+this.fileUploadBucket+".s3.amazonaws.com/",bucket:this.fileUploadBucket,uploadPath:this.fileUploadPath,uploadFileName:this.uploadFileName,realname:this.realname,method:"post",clickable:!0,acceptedFiles:this.acceptedFileTypes,dictResponseError:"Upload failed. Please check your internet connection",previewsContainer:$(a.$el[0]).find("#dropzone-previews")[0],autoProcessQueue:b,multipartUpload:!0,lrToken:this.lrToken,permissions:this.permissions,appAssetsfileName:this.appAssetsfileName,urlParams:this.urlParams,maxFilesize:this.fileSizeLimit}),1==this.singleFileUpload&&this.mydropzone.hiddenFileInput.removeAttribute("multiple"),this.mydropzone.on("sending",function(a,b,c){1==a.chunkedUpload}),this.mydropzone.on("success",function(b,c){if(a.showStatus&&$("#current-item").length){var d=$("#current-item").html();isNaN(d)?$("#current-item").html(0):(d=parseInt(d),$("#current-item").html(d+1))}if(a.collection){a.collection.add(c.image)}var e="https://"+a.fileUploadBucket+".s3.amazonaws.com/"+a.fileUploadPath+"/"+b.currFileName;a.parent.onPublishImageUrl(e,b.currFileName,MediaManager.fileType.LEARNYST_FILE),console.debug("Upload Success:: "+e),a.parent.handleUploadedFile(e,b.currFileName)}),this.mydropzone.on("queuecomplete",function(b){0==a.singleFileUpload?(a.$(".dz-message").show(),a.$("#dropzone-previews").hide(),a.showStatus&&(a.$("#upload-item-status").show(),$("#mediaManagerModal").modal("hide")),a.$(".load-img-error").hide()):a.parent.hide()}),this.mydropzone.on("processing",function(b){a.$(".dz-message").hide(),a.$("#dropzone-previews").show(),a.$(".load-img-error").hide(),a.showStatus&&(a.$("#upload-item-status").length&&a.$("#upload-item-status").show(),$(".multi-upload-close").length&&$(".multi-upload-close").hide())}),this.mydropzone.on("thumbnail",function(b){if(!b.cropped&&0!=a.mandateImageCrop&&1==b.type.startsWith("image")){var c,d,e=b.name,f=new FileReader;f.onloadend=function(){a.$(".uploadLoadingView").hide();var g=(a.$el[0],a.$el[0].getElementsByClassName("save-cropped-img-button")[0]),h=a.$el[0].getElementsByClassName("skip-cropped-img-button")[0];c=a.$el[0].getElementsByClassName("cropper-view")[0],d=a.$el[0].getElementsByClassName("dropzone-view")[0],d.style.display="none",c.style.display="",g.style.display="",h.style.display="",$(c).html(a.cropperTpl({imgUrl:f.result,version:Math.random().toString(36).substring(7)}));var i=NaN,j=NaN;void 0!=a.cropperMinWidth&&(i=a.cropperMinWidth),void 0!=a.cropperMinHeight&&(j=a.cropperMinHeight);var k,l,m=$(a.$el[0]).find("#learnyst-cropper-image > img");1==a.cropperFixedType?m.cropper({aspectRatio:!1,strict:!0,cropBoxResizable:!1,responsive:!0,doubleClickToggle:!1,dragMode:"move",built:function(){m.cropper("setCropBoxData",{width:a.cropFixedWidth,height:a.cropFixedHeight}),m.cropper("setCanvasData",l),m.cropper("setDragMode","move")}}):1==a.cropperMaintainAspectRatio?m.cropper({autoCropArea:.8,aspectRatio:a.cropperAspectRatioWidth/a.cropperAspectRatioHeight,strict:!0,responsive:!0,minCropBoxWidth:i,minCropBoxHeight:j,doubleClickToggle:!1,dragMode:"move",built:function(){m.cropper("setCropBoxData",k),m.cropper("setCanvasData",l),m.cropper("setDragMode","move")}}):m.cropper({autoCropArea:.8,aspectRatio:NaN,strict:!0,responsive:!0,minCropBoxWidth:i,minCropBoxHeight:j,doubleClickToggle:!1,dragMode:"move",built:function(){m.cropper("setCropBoxData",k),m.cropper("setCanvasData",l),m.cropper("setDragMode","move")}}),$(a.$el[0]).find("#cropperSaveButton").on("click",function(f){d.style.display="",c.style.display="none";var h,i=m.cropper("getCroppedCanvas"),j=(e.substring(0,e.lastIndexOf(".")),e.substring(e.lastIndexOf(".")+1));h="png"==j?"image/png":"jpg"==j?"image/jpeg":"jpeg"==j?"image/jpeg":"bmp"==j?"image/bmp":"gif"==j?"image/gif":"image/jpeg";var k=i.toDataURL(h),l=k.split(",")[0].split(":")[1].split(";")[0],n=Base64Binary.decode(k.split(",")[1]),o=new Blob([n],{type:l});a.mydropzone.removeFile(b),o.cropped=!0,o.name=e,a.mydropzone.addFile(o),a.mydropzone.processQueue(),$(a.$el[0]).find("#cropperSaveButton").off("click"),g.style.display="none"}),$(a.$el[0]).find("#cropperSkipButton").on("click",function(e){if(d.style.display="",c.style.display="none",$(a.$el[0]).find("#cropperSkipButton").off("click"),h.style.display="none",b.isDiskFile===!1){a.mydropzone.removeFile(b);var f=b.originalFileUrl.substring(b.originalFileUrl.lastIndexOf("/")+1);a.parent.onPublishImageUrl(b.originalFileUrl,f,MediaManager.fileType.LEARNYST_FILE),a.parent.hide()}else a.mydropzone.processQueue();console.debug("cropper skip clicked")}),a.$el.on("click","[data-method]",function(){var a,b,c=$(this).data();if(m.data("cropper")&&c.method){if(c=$.extend({},c),"undefined"!=typeof c.target&&(a=$(c.target),"undefined"==typeof c.option))try{c.option=JSON.parse(a.val())}catch(d){console.log(d.message)}b=m.cropper(c.method,c.option)}}),$('[data-toggle="tooltip"]').tooltip()},a.$(".uploadLoadingView").show(),f.readAsDataURL(b)}}),this.cropImageUrl&&(this.$(".dz-message").hide(),this.loadUrlAndCropUpload(this.cropImageUrl)),this.mydropzone.on("error",function(a,b,c){-1!==b.indexOf("vaild file name")?alert("Invalid file name. File name contains special characters, please remove whitespaces and special characters"):-1!==b.indexOf("File size is too big")?alert(b):c&&-1!==c.response.indexOf("The difference between the request time and the current time is too large.")?alert("UPLOAD FAILED: Please check your system time and timezone"):void 0==a.errorDisplayed&&(alert("Upload/Download of file "+a.name+" failed! Please check your internet connection and retry"),a.errorDisplayed=!0)}),this},onFocus:function(){},loadUrlAndCropUpload:function(a){var b=new XMLHttpRequest,c=a,d="v="+Math.random().toString(36).substring(7);c+=(c.split("?")[1]?"&":"?")+d,b.open("GET",c,!0),b.responseType="arraybuffer",self=this,this.$(".uploadLoadingView").show(),b.onerror=function(a){self.$(".uploadLoadingView").hide(),self.$(".load-img-error").show()},b.onload=function(a){var b=c.split("?")[0],d=b.substring(b.lastIndexOf("/")+1),e=d.substring(0,d.lastIndexOf(".")),f=d.substring(d.lastIndexOf(".")+1);if(self.$(".uploadLoadingView").hide(),a.target.status>299)return void self.$(".load-img-error").show();var g,h=new Uint8Array(this.response);if("png"==f)g="image/png";else if("jpg"==f)g="image/jpg";else if("jpeg"==f)g="image/jpeg";else if("bmp"==f)g="image/bmp";else{if("gif"!=f)return void self.$(".load-img-error").show();g="image/gif"}var i=new Blob([h],{type:g}),j=(window.URL||window.webkitURL,[i,new ArrayBuffer]),k=e+"_"+Math.random().toString(36).substring(7)+"."+f,l=new File(j,k,{lastModified:new Date(0),type:g});l.isDiskFile=!1,l.originalFileUrl=c,self.mydropzone.addFile(l)},b.send()},showLastOperationStatus:function(){var a=$(this.$el[0]).find("#dropzone-previews")[0].innerHTML;this.showingOperationStatus?($("#operation-status-popover").popover("destroy"),this.showingOperationStatus=!1):($("#operation-status-popover").popover({placement:"top",trigger:"manual",template:'<div style="min-width:700px;" class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content" style="max-width:700px; min-height:230px; max-height:230px; overflow:scroll;"><p></p></div></div>',html:!0,content:'<div class="dropzone" style="border: none; display: block; margin-left: auto; margin-right: auto; text-align: center;">'+a+"</div>"}),$("#operation-status-popover").popover("show"),this.showingOperationStatus=!0)}}),LstMediaManager.Views.UserImageTabView=Backbone.View.extend({userImagesTabTpl:JST["userImagesTab.hbs"],uploadFileTabView:null,lazyLoad:void 0,events:{"click .imgBorder":"imgHighlight","click #userImageSelect":"onUserImgSelect","click #userImageDelete":"onUserImgDelete"},initialize:function(a){console.debug("init UserImageTabView"),this.parent=a.parent,this.deleteImg="deleteImg",this.lrToken=a.lrToken,this.fileUploadBucket=a.fileUploadBucket,this.fileUploadAppType=a.fileUploadAppType,this.fileUploadPath=a.fileUploadPath,this.uploadFileName=a.uploadFileName,this.realname=a.realname,this.writeUserimageRecordToServer=a.writeUserimageRecordToServer,this.writeUserimageServerParams=a.writeUserimageServerParams,this.mandateImageCrop=a.mandateImageCrop,this.singleFileUpload=a.singleFileUpload,this.cropperMaintainAspectRatio=a.cropperMaintainAspectRatio,this.cropperAspectRatioWidth=a.cropperAspectRatioWidth,this.cropperAspectRatioHeight=a.cropperAspectRatioHeight,this.permissions=a.permissions,this.userImageWriteUrl=a.userImageWriteUrl,this.cropperFixedType=a.cropperFixedType,this.cropFixedWidth=a.cropFixedWidth,this.cropFixedHeight=a.cropFixedHeight,this.cropperMinWidth=a.cropperMinWidth,this.cropperMinHeight=a.cropperMinHeight,this.showStatus=a.showStatus},render:function(){return console.debug("Render UserImageTabView"),this.displayImages(),this.listenTo(this.collection,"reset",this.onResetUserImages),this},onFocus:function(){this.lazyLoad&&this.lazyLoad.unveilNow()},onResetUserImages:function(){this.displayImages()},displayImages:function(){var a=this;this.imgCount=this.collection.length,this.imgCount>0?(this.$el.html(this.userImagesTabTpl({imgCount:this.imgCount,medias:this.collection.toJSON(),deleteImg:this.deleteImg})),this.lazyLoad&&this.$(".user_img_scroll").off("scroll"),this.lazyLoad=this.$("img").unveil(300),this.$(".user_img_scroll").on("scroll",function(){a.lazyLoad.unveilNow()})):this.$el.html(this.userImagesTabTpl({imgCount:this.imgCount}))},imgHighlight:function(a){this.$(".imgList").css("border","");var b=$(a.currentTarget).data("img-id");this.$("#imgSelected_"+b).css("border","3px solid #4cbe67"),this.imgSrc=a.currentTarget.src,this.model=this.collection.findWhere({id:parseInt(b)})},onUserImgSelect:function(){void 0===this.imgSrc&&alert("please select an image to upload");var a=this.imgSrc,b=(a.substring(0,a.lastIndexOf("/")),a.substring(a.lastIndexOf("/")+1));if(0==this.mandateImageCrop)this.parent.onPublishImageUrl(a,b,MediaManager.fileType.LEARNYST_FILE),this.parent.hide();else{var c=this.$el;this.uploadFileTabView=new LstMediaManager.Views.UploadFileTabView({el:c,parent:this.parent,collection:this.userImgCollection,lrToken:this.lrToken,fileUploadBucket:this.fileUploadBucket,fileUploadAppType:this.fileUploadAppType,fileUploadPath:this.fileUploadPath,uploadFileName:this.uploadFileName,writeUserimageRecordToServer:this.writeUserimageRecordToServer,writeUserimageServerParams:this.writeUserimageServerParams,acceptedFileTypes:"image/*",mandateImageCrop:this.mandateImageCrop,singleFileUpload:this.singleFileUpload,cropperMaintainAspectRatio:this.cropperMaintainAspectRatio,cropperAspectRatioWidth:this.cropperAspectRatioWidth,cropperAspectRatioHeight:this.cropperAspectRatioHeight,cropImageUrl:this.imgSrc,permissions:this.permissions,writeUserimageServerParams:this.writeUserimageServerParams,writeUserimageRecordToServer:this.writeUserimageRecordToServer,userImageWriteUrl:this.userImageWriteUrl,cropperFixedType:this.cropperFixedType,cropFixedWidth:this.cropFixedWidth,cropFixedHeight:this.cropFixedHeight,cropperMinWidth:this.cropperMinWidth,cropperMinHeight:this.cropperMinHeight,showStatus:this.showStatus}),this.uploadFileTabView.render()}},onUserImgDelete:function(){this.model.destroy({success:function(a,b){console.log("success")},error:function(a,b){console.log("Error")}})},removeSuccess:function(){console.log("deleted")},errorEmbed:function(){console.log("not able to delete")}}),LstMediaManager.Views.LibImageTabView=Backbone.View.extend({libImagesTabTpl:JST["libImagesTab.hbs"],uploadFileTabView:null,lazyLoad:void 0,events:{"click .imgBorder":"imgHighlight","click #libImageSelect":"onLibImgSelect","click .groupIcon":"onGroupIconClick"},initialize:function(a){console.debug("init LibImageTabView"),this.parent=a.parent,this.lrToken=a.lrToken,this.fileUploadBucket=a.fileUploadBucket,this.fileUploadAppType=a.fileUploadAppType,this.fileUploadPath=a.fileUploadPath,this.uploadFileName=a.uploadFileName,this.realname=a.realname,this.writeUserimageRecordToServer=a.writeUserimageRecordToServer,this.writeUserimageServerParams=a.writeUserimageServerParams,this.mandateImageCrop=a.mandateImageCrop,this.singleFileUpload=a.singleFileUpload,this.cropperMaintainAspectRatio=a.cropperMaintainAspectRatio,this.cropperAspectRatioWidth=a.cropperAspectRatioWidth,this.cropperAspectRatioHeight=a.cropperAspectRatioHeight,this.permissions=a.permissions,this.userImageWriteUrl=a.userImageWriteUrl,this.cropperFixedType=a.cropperFixedType,this.cropFixedWidth=a.cropFixedWidth,this.cropFixedHeight=a.cropFixedHeight,this.cropperMinWidth=a.cropperMinWidth,this.cropperMinHeight=a.cropperMinHeight,this.showStatus=a.showStatus},render:function(a){return console.debug("Render ImageTabView"),this.currReqType=a,this.currReqType||(this.currReqType="icons"),this.collection.length>0&&this.displayImages(this.collection[this.currReqType].at(0).attributes.main_type,this.collection[this.currReqType].at(0).attributes.sub_type),this.listenTo(this.collection,"reset",this.onResetLibImages),this},onFocus:function(){this.lazyLoad&&this.lazyLoad.unveilNow()},onResetLibImages:function(){this.displayImages(this.collection[this.currReqType].at(0).attributes.main_type,this.collection[this.currReqType].at(0).attributes.sub_type)},displayImages:function(a,b){var c=this;if(this.imgCount=this.collection.length,this.imgCount>0){this.$el.html(this.libImagesTabTpl({headerImages:this.collection[this.currReqType].toJSON(),images:new LstMediaManager.Collections.LearnystMedias(this.collection.where({main_type:a,sub_type:b})).toJSON()})),this.lazyLoad&&this.$("#libImageList").off("scroll"),this.lazyLoad=this.$("img").unveil(300),this.$("#libImageList").on("scroll",function(){c.lazyLoad.unveilNow()});var d=a+"_"+b;this.$(".groupIcon").css("border",""),this.$("#"+d).css("border","3px solid #4cbe67")}else this.$el.html(this.libImagesTabTpl({imgCount:this.imgCount}))},onGroupIconClick:function(a){this.displayImages($(a.currentTarget).data("main-type"),$(a.currentTarget).data("sub-type"))},imgHighlight:function(a){this.$(".imgList").css("border","");var b=$(a.currentTarget).data("img-id");this.$("#imgSelected_"+b).css("border","3px solid #4cbe67"),this.imgSrc=a.currentTarget.src,this.model=this.collection.findWhere({id:parseInt(b)})},onLibImgSelect:function(){void 0===this.imgSrc&&alert("please select an image to upload");var a=this.imgSrc,b=(a.substring(0,a.lastIndexOf("/")),a.substring(a.lastIndexOf("/")+1));if(0==this.mandateImageCrop)this.parent.onPublishImageUrl(a,b,MediaManager.fileType.LEARNYST_FILE),this.parent.hide();else{var c=this.$el;this.uploadFileTabView=new LstMediaManager.Views.UploadFileTabView({el:c,parent:this.parent,collection:this.userImgCollection,lrToken:this.lrToken,fileUploadBucket:this.fileUploadBucket,fileUploadAppType:this.fileUploadAppType,fileUploadPath:this.fileUploadPath,uploadFileName:this.uploadFileName,realname:this.realname,writeUserimageRecordToServer:this.writeUserimageRecordToServer,writeUserimageServerParams:this.writeUserimageServerParams,acceptedFileTypes:"image/*",mandateImageCrop:this.mandateImageCrop,singleFileUpload:this.singleFileUpload,cropperMaintainAspectRatio:this.cropperMaintainAspectRatio,cropperAspectRatioWidth:this.cropperAspectRatioWidth,cropperAspectRatioHeight:this.cropperAspectRatioHeight,cropImageUrl:this.imgSrc,permissions:this.permissions,writeUserimageServerParams:this.writeUserimageServerParams,writeUserimageRecordToServer:this.writeUserimageRecordToServer,userImageWriteUrl:this.userImageWriteUrl,cropperFixedType:this.cropperFixedType,cropFixedWidth:this.cropFixedWidth,cropFixedHeight:this.cropFixedHeight,cropperMinWidth:this.cropperMinWidth,cropperMinHeight:this.cropperMinHeight,showStatus:this.showStatus}),this.uploadFileTabView.render()}}}),LstMediaManager.Views.ImageCropperTabView=Backbone.View.extend({cropperTabTpl:JST["cropperTab.hbs"],uploadFileTabView:null,initialize:function(a){console.debug("init cropperTabView"),this.parent=a.parent,this.lrToken=a.lrToken,this.fileUploadBucket=a.fileUploadBucket,this.fileUploadAppType=a.fileUploadAppType,this.fileUploadPath=a.fileUploadPath,this.uploadFileName=a.uploadFileName,this.realname=a.realname,this.writeUserimageRecordToServer=a.writeUserimageRecordToServer,this.writeUserimageServerParams=a.writeUserimageServerParams,this.mandateImageCrop=a.mandateImageCrop,this.singleFileUpload=a.singleFileUpload,this.cropperMaintainAspectRatio=a.cropperMaintainAspectRatio,this.cropperAspectRatioWidth=a.cropperAspectRatioWidth,this.cropperAspectRatioHeight=a.cropperAspectRatioHeight,this.cropImageUrl=a.cropImageUrl,this.permissions=a.permissions,this.userImageWriteUrl=a.userImageWriteUrl,this.cropperFixedType=a.cropperFixedType,this.cropFixedWidth=a.cropFixedWidth,this.cropFixedHeight=a.cropFixedHeight,this.cropperMinWidth=a.cropperMinWidth,this.cropperMinHeight=a.cropperMinHeight,this.showStatus=a.showStatus},render:function(){return console.debug("Render cropperTabView"),this.renderCropper(),this},renderCropper:function(){if(void 0===this.cropImageUrl)return void console.eror("Cropper image url undefined");if(null===this.uploadFileTabView){var a=this.$el;this.uploadFileTabView=new LstMediaManager.Views.UploadFileTabView({el:a,parent:this.parent,lrToken:this.lrToken,fileUploadBucket:this.fileUploadBucket,fileUploadAppType:this.fileUploadAppType,fileUploadPath:this.fileUploadPath,uploadFileName:this.uploadFileName,realname:this.realname,writeUserimageRecordToServer:this.writeUserimageRecordToServer,writeUserimageServerParams:this.writeUserimageServerParams,acceptedFileTypes:"image/*",mandateImageCrop:!0,singleFileUpload:!0,cropperMaintainAspectRatio:this.cropperMaintainAspectRatio,cropperAspectRatioWidth:this.cropperAspectRatioWidth,cropperAspectRatioHeight:this.cropperAspectRatioHeight,cropImageUrl:this.cropImageUrl,permissions:this.permissions,writeUserimageServerParams:this.writeUserimageServerParams,writeUserimageRecordToServer:this.writeUserimageRecordToServer,userImageWriteUrl:this.userImageWriteUrl,cropperFixedType:this.cropperFixedType,cropFixedWidth:this.cropFixedWidth,cropFixedHeight:this.cropFixedHeight,cropperMinWidth:this.cropperMinWidth,cropperMinHeight:this.cropperMinHeight,showStatus:this.showStatus}),this.uploadFileTabView.render()}}}),LstMediaManager.Views.VideoEmbedTabView=Backbone.View.extend({embedFileTabTpl:JST["embedFileTab.hbs"],events:{"click .btn-videoembed":"onVideoUrlEmbed"},initialize:function(a){console.debug("init embedTabView"),this.parent=a.parent},render:function(){return console.debug("Render embedTabView"),this.$el.html(this.embedFileTabTpl()),this},onVideoUrlEmbed:function(){var a=this.$("#embedUrl").val().trim(),b=/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/,c=/\/\/(?:www\.)?vimeo.com\/([0-9a-z\-_]+)/i,d=/\/\/(?:www\.)?dacast.com\/([0-9a-z\-_]+)/i;if(""===a)return this.$("#embedUrl-error-msg")[0].style.display="",void(this.$("#embedUrl-help-msg")[0].style.display="none");var e;if(a.match(b))e=MediaManager.fileType.YOUTUBE;else if(a.match(c)&&a.match(c)&&a.match(c)[1])e=MediaManager.fileType.VIMEO;else{if(!(a.match(d)&&a.match(d)&&a.match(d)[1]))return this.$("#embedUrl-error-msg")[0].style.display="",void(this.$("#embedUrl-help-msg")[0].style.display="none");e=MediaManager.fileType.DACAST}this.parent.onPublishImageUrl(a,a,e),this.parent.hide()}}),LstMediaManager.Views.FileSyncTabView=Backbone.View.extend({syncFileTabTpl:JST["syncFileTab.hbs"],events:{"click .btn-dropboxsync":"onDropBoxSyncFiles"},initialize:function(a){console.debug("init syncTabView"),this.parent=a.parent,this.singleFileUpload=a.singleFileUpload,this.acceptedFileTypes=a.acceptedFileTypes},render:function(){return console.debug("Render syncTabView"),this.$el.html(this.syncFileTabTpl()),this},onDropBoxSyncFiles:function(){var a=this,b=!1;0==this.singleFileUpload&&(b=!0);var c=this.acceptedFileTypes.replace(/^\s*|\s*$/g,"").split(/\s*,\s*/),d={success:function(b){for(var c=0;c<b.length;c++){var d=b[c].name.replace(/[^a-zA-Z0-9_.-]/g,"_");a.parent.onPublishImageUrl(b[c].link,d,MediaManager.fileType.DROPBOX)}a.parent.hide()},cancel:function(){},linkType:"direct",multiselect:b,extensions:c};Dropbox.choose(d)}});